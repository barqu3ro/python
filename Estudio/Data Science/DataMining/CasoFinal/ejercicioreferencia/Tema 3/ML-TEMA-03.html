<!DOCTYPE html>
<html lang="en"><head>
<script src="ML-TEMA-03_files/libs/clipboard/clipboard.min.js"></script>
<script src="ML-TEMA-03_files/libs/quarto-html/tabby.min.js"></script>
<script src="ML-TEMA-03_files/libs/quarto-html/popper.min.js"></script>
<script src="ML-TEMA-03_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="ML-TEMA-03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ML-TEMA-03_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="ML-TEMA-03_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.313">

  <meta name="author" content="RamÃ³n A. Carrasco">
  <title>DATA MINING Y MACHINE LEARNING</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="ML-TEMA-03_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="ML-TEMA-03_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="ML-TEMA-03_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="images/logo-enae.css">
  <link href="ML-TEMA-03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="ML-TEMA-03_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="ML-TEMA-03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="ML-TEMA-03_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">DATA MINING Y MACHINE LEARNING</h1>
  <p class="subtitle">Tema 3: Machine Learning Supervisado</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
RamÃ³n A. Carrasco 
</div>
        <p class="quarto-title-affiliation">
            ENAE Business School
          </p>
    </div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Ãndice</h2>
<ul>
<li><a href="#/machine-learning-supervisado" id="/toc-machine-learning-supervisado"><span class="toc-section-number">1</span>  Machine learning supervisado</a></li>
<li><a href="#/Ã¡rboles-de-decisiÃ³n" id="/toc-Ã¡rboles-de-decisiÃ³n"><span class="toc-section-number">2</span>  Ãrboles de decisiÃ³n</a></li>
<li><a href="#/k-nearest-neighbors-knn" id="/toc-k-nearest-neighbors-knn"><span class="toc-section-number">3</span>  K Nearest Neighbors (KNN)</a></li>
<li><a href="#/naive-bayes" id="/toc-naive-bayes"><span class="toc-section-number">4</span>  Naive Bayes</a></li>
<li><a href="#/support-vector-machines-svm" id="/toc-support-vector-machines-svm"><span class="toc-section-number">5</span>  Support Vector Machines (SVM)</a></li>
<li><a href="#/redes-neuronales-artificiales-artificial-neural-networks-ann" id="/toc-redes-neuronales-artificiales-artificial-neural-networks-ann"><span class="toc-section-number">6</span>  Redes neuronales artificiales (artificial neural networks, ANN)</a></li>
<li><a href="#/bagging.-random-forest" id="/toc-bagging.-random-forest"><span class="toc-section-number">7</span>  Bagging. Random Forest</a></li>
<li><a href="#/bossting.-xgboost" id="/toc-bossting.-xgboost"><span class="toc-section-number">8</span>  Bossting. XGboost</a></li>
</ul>
</nav>
</section>
<section>
<section id="machine-learning-supervisado" class="title-slide slide level1 center" data-number="1">
<h1><span class="header-section-number">1</span> Machine learning supervisado</h1>

</section>
<section id="introducciÃ³n" class="slide level2 smaller" data-number="1.1">
<h2><span class="header-section-number">1.1</span> IntroducciÃ³n</h2>
<ul>
<li>Es un aspecto del Machine Learning (ML) que consiste en inferir una funciÃ³n a partir de un conjunto de datos etiquetados</li>
<li>Estos datos estÃ¡n formados por un vector de valores (variables) y un atributo de clase</li>
<li>La funciÃ³n inferida debe ser capaz de predecir la clase a partir de los valores observados</li>
<li>Debe ser capaz de generalizar con instancias no vistas
<ul>
<li>Problema de overfitting (sobreajuste)</li>
</ul></li>
<li>Para que podamos resolver este tipo de problemas, los datos han de estar etiquetados de antemano</li>
<li>El etiquetado de datos es un negocio millonario hoy dÃ­a</li>
<li>Existen otras opciones como el etiquetado automÃ¡tico</li>
</ul>
</section>
<section id="tipos-de-machine-learning-supervisado" class="slide level2 smaller" data-number="1.2">
<h2><span class="header-section-number">1.2</span> Tipos de machine learning supervisado</h2>
<ul>
<li><p>Plateamiento del problema de machine learnig supervisado</p>
<span class="math display">\[\begin{equation}\label{eq:ml}
T = x_1, x_2,.., x_n,
X = x_1, x_2,.., x_n
\end{equation}\]</span>
<p>A partir de un conjunto de ejemplos de la tabla <code>T</code> el modelo aprende: y = f(X) y: es clase objetivo o varible dependiente X: variables independientes</p></li>
<li><p>Tipos:</p>
<ul>
<li>ClasificaciÃ³n: Si la atributo <code>y</code> es discreto o nominal</li>
<li>PredicciÃ³n: Si <code>y</code> es continuo</li>
</ul></li>
<li><p>En el proceso hay dos fases:</p>
<ol type="1">
<li>Aprender la funciÃ³n <code>f</code> con los datos histÃ³ricos de <code>T</code></li>
<li>Aplicar dicha funciÃ³n sobre nuevos casos (o filas) de la tabla <code>X_futuro</code> con el mismo formato de <code>X</code> para calcular el valor correspondiente <code>y</code></li>
</ol></li>
</ul>
</section>
<section id="ejemplos-aplicaciÃ³n-de-ml-supervisado" class="slide level2 smaller" data-number="1.3">
<h2><span class="header-section-number">1.3</span> Ejemplos aplicaciÃ³n de ML Supervisado</h2>
<ul>
<li>En un hospital se miden 17 variables distintas (edad, presiÃ³n sanguÃ­nea, etc.) de los pacientes de nuevo ingreso</li>
<li>Se necesita un sistema de toma de decisiones: Â¿el paciente debe ser ingresado en una unidad de cuidados intensivos?</li>
<li>Como las camas de la UCI son muy caras, el sistema debe ser capaz de identificar aquellos pacientes que no vayan a sobrevivir mÃ¡s de un mes</li>
<li>El problema consiste en identificar a los pacientes de alto-riesgo y discriminarlo de aquellos de bajo-riesgo</li>
</ul>
</section>
<section id="ejemplos-aplicaciÃ³n-de-ml-supervisado-2" class="slide level2 smaller" data-number="1.4">
<h2><span class="header-section-number">1.4</span> Ejemplos aplicaciÃ³n de ML Supervisado 2</h2>
<ul>
<li>Una compaÃ±Ã­a de tarjetas de crÃ©dito recibe cientos de solicitudes diarias con datos de sus clientes:
<ul>
<li>Edad</li>
<li>Ingresos anuales</li>
<li>Estado civil</li>
<li>CalificaciÃ³n crediticiaâ¦</li>
</ul></li>
<li>El sistema debe ser capaz de identificar aquellas solicitudes que deben ser aprobadas y aquÃ©llas que deben ser rechazadas</li>
</ul>
</section>
<section id="conceptos-bÃ¡sicos-de-clasificaciÃ³n" class="slide level2" data-number="1.5">
<h2><span class="header-section-number">1.5</span> Conceptos bÃ¡sicos de clasificaciÃ³n</h2>
<ul>
<li>Objetivo principal: Aprender un modelo a partir de datos previamente etiquetados</li>
<li>Â¿Con quÃ© fin? Clasificar instancias <strong>no vistas previamente</strong> sin etiqueta de clase</li>
<li>Es similar al proceso de aprendizaje humano: nosotros aprendemos de experiencias previas y un modelo de clasificaciÃ³n de datos previamente etiquetados</li>
</ul>
</section>
<section id="concepto-de-apredizaje" class="slide level2 smaller" data-number="1.6">
<h2><span class="header-section-number">1.6</span> Concepto de apredizaje</h2>
<ul>
<li>Aprendizaje: Dado un conjunto de datos D, una tarea T y una medida de rendimiento M, aprender un modelo quiere decir que podamos hacer la tarea T mejor que si no tuviÃ©ramos el modelo de acuerdo a la medida M</li>
<li>Asumimos que el conjunto de datos del que disponemos sigue la misma distribuciÃ³n que los datos reales:
<ul>
<li>A veces esta condiciÃ³n no se cumple</li>
<li>Si la violaciÃ³n de esta condiciÃ³n es muy fuerte la capacidad predictiva del modelo serÃ¡ muy pobre</li>
<li>Por eso es importante evitar el overfittingâ¦</li>
</ul></li>
</ul>
</section>
<section id="proceso-de-aprendizaje-en-clasificaciÃ³n" class="slide level2 smaller" data-number="1.7">
<h2><span class="header-section-number">1.7</span> Proceso de aprendizaje en clasificaciÃ³n</h2>
<ul>
<li>Aprendizaje de un modelo con un conjunto de datos de entrenamiento. Existen diversos enfoques de este proceso (validaciÃ³n cruzada, etc)</li>
<li>ValidaciÃ³n del modelo en un conjunto de instancias de test (no vistas hasta ese momento)</li>
</ul>

<img data-src="images/image-1966418116.png" class="r-stretch"></section>
<section id="proceso-de-aprendizaje-en-clasificaciÃ³n.-validaciÃ³n" class="slide level2 smaller" data-number="1.8">
<h2><span class="header-section-number">1.8</span> Proceso de aprendizaje en clasificaciÃ³n. ValidaciÃ³n</h2>
<ul>
<li>Tenemos que confrontar lo predicho con lo que realmente estaba clasificado cada una de las filas</li>
<li>Esto es posible ya que el conjunto de test tiene el mismo origen que el de entrenamiento</li>
<li>El conjunto de test cumple la funciÃ³n de validar cÃ³mo se va a comportar el modelo ante datos nuevos que no conoce</li>
</ul>

<img data-src="images/image-919922696.png" class="r-stretch"></section>
<section id="proceso-de-aplicaciÃ³n-modelo-de-clasificaciÃ³n" class="slide level2" data-number="1.9">
<h2><span class="header-section-number">1.9</span> Proceso de aplicaciÃ³n modelo de clasificaciÃ³n</h2>
<ul>
<li>Los modelos de preprocesamiento (si es que ha sido necesario hacerlo) y de machine learning son aplicados a los datos reales para que prediga la clase objetivo y su probabilidad</li>
</ul>

<img data-src="images/image-1647855682.png" class="r-stretch"></section>
<section id="matriz-de-confusiÃ³n" class="slide level2" data-number="1.10">
<h2><span class="header-section-number">1.10</span> Matriz de confusiÃ³n</h2>
<ul>
<li>Nos permite validar un clasificador</li>
<li>Para un clase objetivo binaria serÃ­a:,</li>
</ul>

<img data-src="images/image-1840767685.png" class="r-stretch"></section>
<section id="matriz-de-confusiÃ³n.-medidas-asociadas" class="slide level2 smaller" data-number="1.11">
<h2><span class="header-section-number">1.11</span> Matriz de confusiÃ³n. Medidas asociadas</h2>
<ul>
<li>Verdaderos Positivos (TP)</li>
<li>Verdaderos Negativos (TN)</li>
<li>Falsos Positivos (FP) (Error Tipo I)</li>
<li>Falsos Negativos (FN) (Error Tipo II)</li>
<li>Sensibilidad//Recall/: TP/(TP+FN)</li>
<li>RazÃ³n de Falsos Positivos: FP/(FP+TN)</li>
<li>Accuracy: (TP+TN)/(TP+TN+FP+FN)</li>
<li>Precision: TP/(TP+FP)</li>
<li>Especicifidad: TN/(TN+FP)=1-FPF</li>
</ul>
</section>
<section id="matriz-de-confusiÃ³n-para-multiclases" class="slide level2 smaller" data-number="1.12">
<h2><span class="header-section-number">1.12</span> Matriz de confusiÃ³n para multiclases</h2>
<p>La matriz de confusiÃ³n se puede generaralizar cuando tenemos mÃ¡s de dos clases objetivo</p>

<img data-src="images/image-200899671.png" class="r-stretch"></section>
<section id="especificidad-y-sensitividad" class="slide level2 smaller" data-number="1.13">
<h2><span class="header-section-number">1.13</span> Especificidad y sensitividad</h2>
<ul>
<li>Hay que aÃ±adirlas siempre al cÃ¡lculo de la precisiÃ³n, especialmente con problemas desbalanceados</li>
</ul>

<img data-src="images/image-242256751.png" class="r-stretch"></section>
<section id="curva-roc-de-un-punto" class="slide level2 smaller" data-number="1.14">
<h2><span class="header-section-number">1.14</span> Curva ROC de un punto</h2>
<ul>
<li>Eje vertical: %Verdaderos Positivos. TPr = VP/(VP+FN)</li>
<li>Eje horizontal: %Falso Positivos. FPr = FP/(FP+VN)</li>
</ul>

<img data-src="images/image-771281488.png" class="r-stretch"></section>
<section id="curva-roc-de-mÃ¡s-puntos" class="slide level2 smaller" data-number="1.15">
<h2><span class="header-section-number">1.15</span> Curva ROC de mÃ¡s puntos</h2>
<ul>
<li>En este caso necesitamos obtener la probabilidad de la clase objetivo</li>
<li>Se pueden usar distintos umbrales para considerar positiva la clase objetivo obteniendose una curva ROC</li>
</ul>

<img data-src="images/image-2105568187.png" class="r-stretch"></section>
<section id="otras-medidas-de-calidad" class="slide level2 smaller" data-number="1.16">
<h2><span class="header-section-number">1.16</span> Otras medidas de calidad</h2>
<ul>
<li>Alternativamente, se puede pintar una curva de tipo âprecision-recallâ</li>
<li>Mejor que la curva ROC cuando hay desbalanceo entre las clases
<ul>
<li>No usa los TN, sÃ³lo se fija en los aciertos de la clase minoritaria</li>
</ul></li>
<li>TambiÃ©n permite calcular medidas cuantitativas
<ul>
<li>F1-score: media harmÃ³nica</li>
<li>AUC: igual que la curva ROC</li>
</ul></li>
</ul>
</section>
<section id="otras-medidas-de-calidad-2" class="slide level2 smaller" data-number="1.17">
<h2><span class="header-section-number">1.17</span> Otras medidas de calidad 2</h2>
<ul>
<li><p>Cohenâs Kappa: similar al accuracy pero teniendo en cuenta el ratio de acierto de un clasificador aleatorio. InterpretaciÃ³n tÃ­pica:</p>
<ul>
<li>0.00-0.20: slight</li>
<li>0.21-0.40: fair</li>
<li>0.41-0.60: moderate</li>
<li>0.61-0.80: substantial</li>
<li>0.81-1.00: almost perfect</li>
</ul></li>
</ul>

<img data-src="images/image-113888173.png" class="r-stretch"></section>
<section id="otras-medidas-de-calidad-3" class="slide level2" data-number="1.18">
<h2><span class="header-section-number">1.18</span> Otras medidas de calidad 3</h2>
<p>McNemarâs test: test de homogeneidad de una matriz de confusiÃ³n:</p>
<ul>
<li>ComparÃ¡ndolo con un clasicador aleatorio, mide si acierta de forma similar</li>
<li>Hay que rechazar la hipÃ³tesis nula (p-valor pequeÃ±o) de que existen diferencias entre ambos clasificadores</li>
</ul>
</section>
<section id="hold-out" class="slide level2 smaller" data-number="1.19">
<h2><span class="header-section-number">1.19</span> Hold-out</h2>
<ul>
<li>Consiste en dividir la BD en dos conjuntos independientes: entrenamiento (Xy_train) y test (Xy_test)</li>
<li>El tamaÃ±o del Xy_train normalmente es mayor que el del Xy_test (2/3, 1/3, 4/5, 1/5,â¦)</li>
<li>Los elementos del Xy_train suelen obtenerse mediante muestreo sin reemplazamiento de la BD inicial.</li>
<li>El Xy_test estÃ¡ formado por los elementos no incluidos en el Xy_train</li>
<li>Suele utilizarse en BBDD grandes</li>
</ul>

<img data-src="images/image-752245430.png" class="r-stretch"></section>
<section id="three-way-data-split" class="slide level2 smaller" data-number="1.20">
<h2><span class="header-section-number">1.20</span> Three-way data split</h2>
<p>Consiste en dividir la BD en tres conjuntos independientes:</p>
<ul>
<li>Entrenamiento: para la construcciÃ³n de los modelos</li>
<li>ValidaciÃ³n: nos permite elegir quÃ© modelo se comporta mejor</li>
<li>Test o Holdout: nos permite obtener la precisiÃ³n final del modelo elegido</li>
</ul>

<img data-src="images/image-594361734.png" class="r-stretch"></section>
<section id="three-way-data-split-para-selecciÃ³n-del-modelo" class="slide level2 smaller" data-number="1.21">
<h2><span class="header-section-number">1.21</span> Three-way data split para selecciÃ³n del modelo</h2>

<img data-src="images/image-1283451270.png" class="r-stretch"></section>
<section id="validaciÃ³n-cruzada-k-fold-cross-validation" class="slide level2 smaller" data-number="1.22">
<h2><span class="header-section-number">1.22</span> ValidaciÃ³n cruzada (K-fold cross validation)</h2>
<ul>
<li>Consiste en dividir la BD en k subconjuntos (folds), {S1,â¦,Sk} de igual tamaÃ±o</li>
<li>Aprender k clasificadores utilizando en cada uno de ellos un conjunto entrenamiento distinto.</li>
<li>Validar con el conjunto de test correspondiente</li>
<li>Devolver como tasa de acierto (error) el promedio obtenido en las k iteraciones</li>
<li>En la validaciÃ³n cruzada estratificada: Los subconjuntos se estratifican en funciÃ³n de la variable clase</li>
<li>Valores tÃ­picos de k=5,10â¦</li>
<li>Suele utilizarse en BBDD de tamaÃ±o moderado</li>
</ul>
</section>
<section id="validaciÃ³n-cruzada-k-fold-cross-validation-2" class="slide level2" data-number="1.23">
<h2><span class="header-section-number">1.23</span> ValidaciÃ³n cruzada (K-fold cross validation) 2</h2>
<p>Ejemplo con k=4</p>

<img data-src="images/image-333655801.png" class="r-stretch"></section>
<section id="selecciÃ³n-del-modelo-k-fold-cross-validation" class="slide level2 smaller" data-number="1.24">
<h2><span class="header-section-number">1.24</span> SelecciÃ³n del modelo (K-fold cross validation)</h2>

<img data-src="images/image-1471438633.png" class="r-stretch"></section>
<section id="random-subsampling-cross-validation" class="slide level2 smaller" data-number="1.25">
<h2><span class="header-section-number">1.25</span> Random subsampling cross validation</h2>
<ul>
<li>Consiste en dividir la BD en k subconjuntos entrenamiento/test con muestreo aleatorio sin reemplazamiento</li>
<li>En cada divisiÃ³n se extrae el modelo con el conjunto de entrenamiento y se evalÃºa con el de test</li>
<li>La estimaciÃ³n se promedia</li>
</ul>

<img data-src="images/image-1989690449.png" class="r-stretch"></section>
<section id="leaving-one-out" class="slide level2 smaller" data-number="1.26">
<h2><span class="header-section-number">1.26</span> Leaving-one-out</h2>
<ul>
<li>Es un caso especial de validaciÃ³n cruzada en el que k es igual al nÃºmero de registros</li>
<li>Tiene la ventaja de que el proceso es determinista y de que en todo momento se utiliza el mÃ¡ximo posible de datos para la inducciÃ³n del clasificador</li>
<li>Se utiliza en BBDD muy pequeÃ±as, debido a su alto costo computacional</li>
</ul>

<img data-src="images/image-463688701.png" class="r-stretch"></section>
<section id="bootstrap" class="slide level2 smaller" data-number="1.27">
<h2><span class="header-section-number">1.27</span> Bootstrap</h2>
<ul>
<li>EstÃ¡ basado en el proceso de muestreo con reemplazo</li>
<li>A partir de una BD con n registros se obtiene un CE con n casos</li>
<li>Como conjunto de test se utilizan los registros de la BD no seleccionados para el de entrenamiento</li>
<li>Â¿CuÃ¡ntos casos habrÃ¡ en el de entrenamiento? Â¿quÃ© porcentaje respecto a n?
<ul>
<li>Esta tÃ©cnica se conoce como 0.632 bootstrap (ese % para entrenamiento y resto para test)</li>
<li>Se calcula partiendo de que la probabilidad de elegir un registro sea 1/n</li>
</ul></li>
<li>El error sobre el CT suele ser bastante pesimista por lo que se corrige <img data-src="images/image-1493131626.png"></li>
</ul>
</section>
<section id="elecciÃ³n-del-tamaÃ±ano-y-nÃºmero-de-particiones" class="slide level2 smaller" data-number="1.28">
<h2><span class="header-section-number">1.28</span> ElecciÃ³n del tamaÃ±ano y nÃºmero de particiones</h2>
<ul>
<li>Alto nÃºmero de particiones entrenamiento / test:
<ul>
<li>Sesgo de la estimaciÃ³n del error pequeÃ±o: Estimador bastante preciso</li>
<li>Alta varianza del estimador</li>
<li>Costo computacional alto</li>
</ul></li>
<li>Bajo nÃºmero de particiones entrenamiento / test:
<ul>
<li>Sesgo alto de la estimaciÃ³n</li>
<li>Varianza baja</li>
<li>Costo computacional reducido</li>
</ul></li>
<li>La elecciÃ³n del nÃºmero de particiones depende del tamaÃ±o del conjunto de datos
<ul>
<li>Para datasets grandes, 3 es un nÃºmero es adecuado</li>
<li>Para datasets pequeÃ±os, mayor e incluso leaving one out</li>
<li>Un valor comÃºn para k-fold cross validation es K=5 Ã³ 10</li>
</ul></li>
</ul>
</section>
<section id="proceso-de-aprendizaje-en-regresiÃ³n" class="slide level2 smaller" data-number="1.29">
<h2><span class="header-section-number">1.29</span> Proceso de aprendizaje en RegresiÃ³n</h2>
<ul>
<li>El proceso es anÃ¡logo en visto al de clasificaciÃ³n:</li>
</ul>

<img data-src="images/image-1862492279.png" class="r-stretch"></section>
<section id="proceso-de-aprendizaje-en-regresiÃ³n.-validaciÃ³n" class="slide level2 smaller" data-number="1.30">
<h2><span class="header-section-number">1.30</span> Proceso de aprendizaje en RegresiÃ³n. ValidaciÃ³n</h2>
<ul>
<li><p>En este caso tenemos que contrastar dos columnas numÃ©ricas</p>
<ul>
<li><p>El valor real</p></li>
<li><p>El valor predicho</p></li>
</ul></li>
</ul>

<img data-src="images/image-73993490.png" class="r-stretch"></section>
<section id="proceso-de-aplicaciÃ³n-del-modelo-de-regresiÃ³n" class="slide level2" data-number="1.31">
<h2><span class="header-section-number">1.31</span> Proceso de aplicaciÃ³n del modelo de regresiÃ³n</h2>
<ul>
<li>Es anÃ¡logo al que se ha visto en clasificaciÃ³n:</li>
</ul>

<img data-src="images/image-48276691.png" class="r-stretch"></section>
<section id="medidas-de-validaciÃ³n-en-regresiÃ³n" class="slide level2 smaller" data-number="1.32">
<h2><span class="header-section-number">1.32</span> Medidas de validaciÃ³n en regresiÃ³n</h2>
<ul>
<li>Todas las tÃ©cnicas de validaciÃ³n estudiadas en clasificaciÃ³n son vÃ¡lidas para predicciÃ³n numÃ©rica</li>
<li>La diferencia estÃ¡ en que ahora debemos medir el error de otra forma</li>
<li>Debemos medir el error cometido al aproximar un conjunto de valores {v1,â¦,vn} por su estimaciÃ³n {vâ1,â¦,vân}</li>
</ul>

<img data-src="images/image-110537145.png" class="r-stretch"></section>
<section id="el-problema-del-sobreaprendizaje" class="slide level2 smaller" data-number="1.33">
<h2><span class="header-section-number">1.33</span> El problema del sobreaprendizaje</h2>
<ul>
<li>Sobreaprendizaje debido a la complejidad del clasificador: a mayor complejidad mayor sobreaprendizaje</li>
</ul>

<img data-src="images/image-403589661.png" class="r-stretch"></section>
<section id="sec-hold-out-r" class="slide level2 smaller" data-number="1.34">
<h2><span class="header-section-number">1.34</span> Ejemplo R de preparaciÃ³n hold-out para entrenamiento de modelos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># ############################################################</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># Parte general para todos los modelos de clasificaciÃ³n IRIS</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co"># ############################################################</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'caret'</span>)) <span class="fu">install.packages</span>(<span class="st">'caret'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(caret)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'Hmisc'</span>)) <span class="fu">install.packages</span>(<span class="st">'Hmisc'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'ROCR'</span>)) <span class="fu">install.packages</span>(<span class="st">'ROCR'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co"># lectura de datos con el data.frame iris</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">data</span>(iris)</span>
<span id="cb1-17"><a href="#cb1-17"></a>i_data <span class="ot">&lt;-</span> iris</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># identificar posiciones clase objetivo y variables independientes</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>y <span class="ot">&lt;-</span> <span class="fu">ncol</span>(i_data)</span>
<span id="cb1-21"><a href="#cb1-21"></a>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(y<span class="dv">-1</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">head</span>(i_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># partir en train y test</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(i_data[,y], <span class="at">p =</span> .<span class="dv">7</span>,<span class="at">list=</span>F, <span class="at">times=</span><span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>Xy_train <span class="ot">&lt;-</span> i_data[trainIndex,]</span>
<span id="cb3-5"><a href="#cb3-5"></a>Xy_test <span class="ot">&lt;-</span> i_data[<span class="sc">-</span>trainIndex,]</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># construimos fÃ³rmula y=f(X) para indicarles a los modelos clase objetivo</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>dep <span class="ot">&lt;-</span> <span class="fu">colnames</span>(Xy_train[y])</span>
<span id="cb3-9"><a href="#cb3-9"></a>form <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste0</span>(dep,<span class="st">"~."</span>))</span>
<span id="cb3-10"><a href="#cb3-10"></a>form</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Species ~ .</code></pre>
</div>
</div>
</section>
<section id="sec-hold-out-python" class="slide level2 smaller" data-number="1.35">
<h2><span class="header-section-number">1.35</span> Ejemplo Python de preparaciÃ³n hold-out para entrenamiento de modelos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># ############################################################</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Parte general para todos los modelos de clasificaciÃ³n IRIS</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># ############################################################</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># librerÃ­as generales</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># pip install scikitplot</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># lectura de datos y convertir dataframe</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>iris <span class="op">=</span> datasets.load_iris()</span>
<span id="cb5-18"><a href="#cb5-18"></a>i_data <span class="op">=</span> pd.DataFrame(iris.data, columns<span class="op">=</span>iris.feature_names)</span>
<span id="cb5-19"><a href="#cb5-19"></a>i_data[<span class="st">'class'</span>] <span class="op">=</span> iris.target</span>
<span id="cb5-20"><a href="#cb5-20"></a>i_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sepal length (cm)  sepal width (cm)  ...  petal width (cm)  class
0                5.1               3.5  ...               0.2      0
1                4.9               3.0  ...               0.2      0
2                4.7               3.2  ...               0.2      0
3                4.6               3.1  ...               0.2      0
4                5.0               3.6  ...               0.2      0

[5 rows x 5 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># identificar clase objetivo y variables independientes</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>X <span class="op">=</span> i_data.loc[:, i_data.columns <span class="op">!=</span> <span class="st">'class'</span>]</span>
<span id="cb7-3"><a href="#cb7-3"></a>y <span class="op">=</span> i_data[<span class="st">'class'</span>]</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># partir en train y test</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co"># modelo de preprocesamiento obtenido desde el conjunto de entrenamiento</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>md_prepro <span class="op">=</span> StandardScaler()</span>
<span id="cb7-11"><a href="#cb7-11"></a>md_prepro.fit(X_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>StandardScaler()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># escalamos conjunto entrenamiento</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>X_train_scaled <span class="op">=</span> md_prepro.transform(X_train)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># visualizamos estadÃ­sticas</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>df_describe <span class="op">=</span> pd.DataFrame(X_train_scaled)</span>
<span id="cb8-6"><a href="#cb8-6"></a>df_describe.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  0             1             2             3
count  1.050000e+02  1.050000e+02  1.050000e+02  1.050000e+02
mean  -4.829999e-15  1.932845e-15 -3.066330e-16  3.066330e-16
std    1.004796e+00  1.004796e+00  1.004796e+00  1.004796e+00
min   -1.854900e+00 -2.089062e+00 -1.662958e+00 -1.539213e+00
25%   -9.713279e-01 -6.152556e-01 -1.311275e+00 -1.131432e+00
50%   -8.775611e-02 -1.239869e-01  3.299121e-01  9.191264e-02
75%    6.695911e-01  6.129162e-01  7.402090e-01  7.715483e-01
max    2.310510e+00  3.314894e+00  1.795258e+00  1.723038e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># escalamos conjunto de test (con el modelo de preprocesamiento del conjunto de entrenamiento)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>X_test_scaled <span class="op">=</span> md_prepro.transform(X_test)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># visualizamos estadÃ­sticas</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>df_describe <span class="op">=</span> pd.DataFrame(X_test_scaled)</span>
<span id="cb10-6"><a href="#cb10-6"></a>df_describe.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               0          1          2          3
count  45.000000  45.000000  45.000000  45.000000
mean   -0.110196   0.056145  -0.154629  -0.149736
std     1.142153   1.221903   1.105457   1.110303
min    -1.981124  -2.580331  -1.604344  -1.539213
25%    -0.971328  -0.615256  -1.428503  -1.403286
50%    -0.340205  -0.123987   0.095457  -0.044015
75%     0.543367   0.858551   0.740209   0.907475
max     2.562959   2.823626   1.678030   1.451184</code></pre>
</div>
</div>
</section></section>
<section>
<section id="Ã¡rboles-de-decisiÃ³n" class="title-slide slide level1 center" data-number="2">
<h1><span class="header-section-number">2</span> Ãrboles de decisiÃ³n</h1>

</section>
<section id="introducciÃ³n-Ã¡rboles" class="slide level2 smaller" data-number="2.1">
<h2><span class="header-section-number">2.1</span> IntroducciÃ³n Ã¡rboles</h2>

<img data-src="images/image-221753580.png" class="r-stretch"></section>
<section id="introducciÃ³n-Ã¡rboles-2" class="slide level2 smaller" data-number="2.2">
<h2><span class="header-section-number">2.2</span> IntroducciÃ³n Ã¡rboles 2</h2>

<img data-src="images/image-2070491360.png" class="r-stretch"></section>
<section id="introducciÃ³n-Ã¡rboles-3" class="slide level2 smaller" data-number="2.3">
<h2><span class="header-section-number">2.3</span> IntroducciÃ³n Ã¡rboles 3</h2>

<img data-src="images/image-1859924272.png" class="r-stretch"></section>
<section id="algoritmos-de-Ã¡rboles" class="slide level2" data-number="2.4">
<h2><span class="header-section-number">2.4</span> Algoritmos de Ã¡rboles</h2>
<p>Existen mÃºltiples algoritmos:</p>
<ul>
<li>Algoritmo de Hunt (uno de los primeros)</li>
<li>CART</li>
<li>ID3, C4.5</li>
<li>SLIQ, SPRINTâ¦</li>
</ul>
</section>
<section id="algoritmo-de-hunt" class="slide level2 smaller" data-number="2.5">
<h2><span class="header-section-number">2.5</span> Algoritmo de Hunt</h2>
<p>Muchos algoritmos se basan en un enfoque âtop-downâ o âdivide y vencerÃ¡sâ: por ejemplo, el algoritmo de Hunt:</p>
<ul>
<li>Sea Dt el conjunto de registros de entrenamiento en nodo t dado</li>
<li>Sea yt = y1, y2, â¦, yc el conjunto de etiquetas de clase</li>
<li>Si todos los registros Dt pertenecen a la misma clase
<ul>
<li>Entonces es t es un nodo hoja que se etiqueta como yt</li>
</ul></li>
<li>Si Dt contiene registros que pertenecen a mÃ¡s de una clase
<ul>
<li>se escoge una variable (atributo) para dividir los datos en subconjuntos mÃ¡s pequeÃ±os</li>
</ul></li>
<li>Recursivamente se aplica el procedimiento a cada subconjunto</li>
</ul>
</section>
<section id="algoritmo-de-hunt-2" class="slide level2" data-number="2.6">
<h2><span class="header-section-number">2.6</span> Algoritmo de Hunt 2</h2>

<img data-src="images/image-96546080.png" class="r-stretch"></section>
<section id="algoritmo-de-hunt-3" class="slide level2 smaller" data-number="2.7">
<h2><span class="header-section-number">2.7</span> Algoritmo de Hunt 3</h2>
<p>Para poder aplicar este algoritmo, tenemos que responder algunas preguntasâ¦</p>
<ul>
<li>Â¿CÃ³mo vamos a dividir los registros?
<ul>
<li>Â¿CÃ³mo especicificar la condiciÃ³n de divisiÃ³n?</li>
<li>Â¿QuÃ© variables a usar y en quÃ© orden?Â¿qÃºe criterio puede determinar la mejor divisiÃ³n?</li>
</ul></li>
<li>Criterio de parada</li>
<li>Preprunning: Se detiene antes de construir el Ã¡rbol complejo (p.e. se para cuando todos los registros son de la misma clase, o tiene pocos registros, o no provoca mejora en la impurezaâ¦)</li>
<li>Posprunning: se construye el Ã¡rbol completo y se poda con alguna medida de error basÃ¡ndose en los datos de validaciÃ³n</li>
</ul>
</section>
<section id="condiciÃ³n-de-divisiÃ³n" class="slide level2" data-number="2.8">
<h2><span class="header-section-number">2.8</span> CondiciÃ³n de divisiÃ³n</h2>
<ul>
<li>Nominales vs.&nbsp;ordinales vs.&nbsp;cuantitativas</li>
<li>DivisiÃ³n binaria vs.&nbsp;mÃºltiple</li>
</ul>

<img data-src="images/image-696018820.png" class="r-stretch"></section>
<section id="condiciÃ³n-de-divisiÃ³n-2" class="slide level2" data-number="2.9">
<h2><span class="header-section-number">2.9</span> CondiciÃ³n de divisiÃ³n 2</h2>
<ul>
<li>Preferiremos aquellas divisiones con una distribuciÃ³n menos homogÃ©nea de los registros en funciÃ³n de su clase</li>
<li>Necesitamos una medida de impureza para las divisiones</li>
</ul>

<img data-src="images/image-578257949.png" class="r-stretch"></section>
<section id="condiciÃ³n-de-divisiÃ³n-3" class="slide level2" data-number="2.10">
<h2><span class="header-section-number">2.10</span> CondiciÃ³n de divisiÃ³n 3</h2>

<img data-src="images/image-1010050414.png" class="r-stretch"></section>
<section id="medidas-de-impureza" class="slide level2" data-number="2.11">
<h2><span class="header-section-number">2.11</span> Medidas de impureza</h2>
<p>Existen diversas formas de medirla. Ejemplos:</p>

<img data-src="images/image-196765227.png" class="r-stretch"></section>
<section id="medidas-de-impureza-2" class="slide level2" data-number="2.12">
<h2><span class="header-section-number">2.12</span> Medidas de impureza 2</h2>

<img data-src="images/image-445456217.png" class="r-stretch"></section>
<section id="comparativa-de-algoritmos" class="slide level2 smaller" data-number="2.13">
<h2><span class="header-section-number">2.13</span> Comparativa de algoritmos</h2>
<ul>
<li>ID3 es uno de los primeros algoritmos de inducciÃ³n de Ã¡rboles</li>
<li>C4.5 lo mejora en:
<ul>
<li>Acepta atributos discretos y continuos</li>
<li>Soporta valores nulos</li>
<li>Implementa estrategia de prunning bottom-up</li>
<li>Permite asignar pesos a los distintos atributos</li>
</ul></li>
<li>CART es similar a C4.5. Se diferencian en:
<ul>
<li>La estrategia de prunning es ligeramente distinta</li>
<li>TambiÃ©n la de imputaciÃ³n de valores nulos</li>
<li>Usa el Ã­ndice de GINI mientras C4.5 usa la Ganancia o el Ratio de Ganancia</li>
</ul></li>
</ul>
</section>
<section id="Ã¡rboles-de-regresiÃ³n" class="slide level2" data-number="2.14">
<h2><span class="header-section-number">2.14</span> Ãrboles de regresiÃ³n</h2>
<ul>
<li>Los Ã¡rboles de decisiÃ³n tambiÃ©n pueden ser usados para hacer regresiÃ³n</li>
<li>La idea es que cada nodo hoja prediga un valor numÃ©rico en lugar de un valor categÃ³rico</li>
</ul>

<img data-src="images/image-1909597357.png" class="r-stretch"></section>
<section id="Ã¡rboles-de-regresiÃ³n-2" class="slide level2 smaller" data-number="2.15">
<h2><span class="header-section-number">2.15</span> Ãrboles de regresiÃ³n 2</h2>
<ul>
<li>A diferencia de los Ã¡rboles de clasicaciÃ³n se usa la desviaciÃ³n tÃ­pica como mÃ©trica para medir la homegeneidad de u nodo</li>
<li>La media es el valor que predice el Ã¡rbol</li>
<li>La desviaciÃ³n tÃ­pica se usa para decidir cÃ³mo se hacen las divisiones</li>
<li>El coeficiente de variaciÃ³n y nÃºmero de instancias se usan como criterio de parada</li>
</ul>

<img data-src="images/image-1930864979.png" class="r-stretch"></section>
<section id="Ã¡rboles-de-regresiÃ³n-3" class="slide level2 smaller" data-number="2.16">
<h2><span class="header-section-number">2.16</span> Ãrboles de regresiÃ³n 3</h2>
<p>En cada nodo, para hacer la divisiÃ³n lo que se hace es:</p>
<ol type="1">
<li>Calcular la desviaciÃ³n tÃ­pica en ese nodo</li>
<li>Seleccionar varios atributos para hacer la divisiÃ³n</li>
<li>Calcular la desviaciÃ³n tÃ­pica media para cada uno de los atributos</li>
<li>Calcular el decremento de la desviaciÃ³n para cada uno de ellos</li>
<li>Seleccionamos el atributo que mayor decremento introduce</li>
</ol>
</section>
<section id="ejemplo-r-de-Ã¡rboles-de-clasificaciÃ³n" class="slide level2 smaller" data-number="2.17">
<h2><span class="header-section-number">2.17</span> Ejemplo R de Ã¡rboles de clasificaciÃ³n</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="do">#############################################</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="do">## Ãrbol de clasificaciÃ³n</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="do">#############################################</span></span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co"># librerÃ­as para Ã¡rboles</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'partykit'</span>)) <span class="fu">install.packages</span>(<span class="st">'partykit'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="fu">library</span>(partykit)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'party'</span>)) <span class="fu">install.packages</span>(<span class="st">'party'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="fu">library</span>(party)</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>md_tree <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb12-16"><a href="#cb12-16"></a>            <span class="at">data=</span>Xy_train, </span>
<span id="cb12-17"><a href="#cb12-17"></a>            <span class="at">method=</span><span class="st">"ctree"</span>, </span>
<span id="cb12-18"><a href="#cb12-18"></a>            <span class="at">trControl=</span>fitControl)</span>
<span id="cb12-19"><a href="#cb12-19"></a></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_tree, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb14-3"><a href="#cb14-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         14         2
  virginica       0          1        13

Overall Statistics
                                         
               Accuracy : 0.9333         
                 95% CI : (0.8173, 0.986)
    No Information Rate : 0.3333         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.9            
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.9333           0.8667
Specificity                 1.0000            0.9333           0.9667
Pos Pred Value              1.0000            0.8750           0.9286
Neg Pred Value              1.0000            0.9655           0.9355
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3111           0.2889
Detection Prevalence        0.3333            0.3556           0.3111
Balanced Accuracy           1.0000            0.9333           0.9167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_tree, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  setosa versicolor virginica
1      1          0         0
2      1          0         0
3      1          0         0
4      1          0         0
5      1          0         0
6      1          0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  1 1 1 1 1 1 1 1 1 1 ...
 $ versicolor  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ virginica   : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># curvas roc</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb20-4"><a href="#cb20-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb20-5"><a href="#cb20-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb20-9"><a href="#cb20-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb20-10"><a href="#cb20-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb20-14"><a href="#cb20-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb20-15"><a href="#cb20-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb20-16"><a href="#cb20-16"></a></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-3-2.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-3-3.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># visualizaciÃ³n del Ã¡rbol</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>md_tree<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Conditional inference tree with 4 terminal nodes

Response:  .outcome 
Inputs:  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width 
Number of observations:  105 

1) Petal.Length &lt;= 1.9; criterion = 1, statistic = 98.171
  2)*  weights = 35 
1) Petal.Length &gt; 1.9
  3) Petal.Width &lt;= 1.6; criterion = 1, statistic = 48.475
    4) Petal.Length &lt;= 4.5; criterion = 0.999, statistic = 14.282
      5)*  weights = 27 
    4) Petal.Length &gt; 4.5
      6)*  weights = 9 
  3) Petal.Width &gt; 1.6
    7)*  weights = 34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">plot</span>(md_tree<span class="sc">$</span>finalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-3-4.png" width="960"></p>
</div>
</div>
</section>
<section id="ejemplo-python-Ã¡rboles-de-clasificaciÃ³n" class="slide level2 smaller" data-number="2.18">
<h2><span class="header-section-number">2.18</span> Ejemplo Python Ã¡rboles de clasificaciÃ³n</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#############################################</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">## Ãrbol de clasificaciÃ³n</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#############################################</span></span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># librerÃ­as necesarias</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, export_text</span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb26-11"><a href="#cb26-11"></a>md_tree <span class="op">=</span> DecisionTreeClassifier()</span>
<span id="cb26-12"><a href="#cb26-12"></a>md_tree.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>y_pred <span class="op">=</span> md_tree.predict(X_test)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>o_pred <span class="op">=</span> pd.concat([X_test,y_test],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a>o_pred[<span class="st">'class_pred'</span>]<span class="op">=</span>y_pred</span>
<span id="cb27-7"><a href="#cb27-7"></a>o_pred.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sepal length (cm)  sepal width (cm)  ...  class  class_pred
72                 6.3               2.5  ...      1           1
112                6.8               3.0  ...      2           2
132                6.4               2.8  ...      2           2
88                 5.6               3.0  ...      1           1
37                 4.9               3.6  ...      0           0

[5 rows x 6 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0 10  0]
 [ 0  2 15]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.83      1.00      0.91        10
           2       1.00      0.88      0.94        17

    accuracy                           0.96        45
   macro avg       0.94      0.96      0.95        45
weighted avg       0.96      0.96      0.96        45</code></pre>
</div>
</div>
</section>
<section id="ejemplo-python-Ã¡rboles-de-clasificaciÃ³n-2" class="slide level2 smaller" data-number="2.19">
<h2><span class="header-section-number">2.19</span> Ejemplo Python Ã¡rboles de clasificaciÃ³n 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>y_test_proba_predict <span class="op">=</span> md_tree.predict_proba(X_test)</span>
<span id="cb33-3"><a href="#cb33-3"></a>y_test_proba_predict[:<span class="dv">5</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([[0., 1., 0.],
       [0., 0., 1.],
       [0., 0., 1.],
       [0., 1., 0.],
       [1., 0., 0.]])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># curva roc</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb35-3"><a href="#cb35-3"></a></span>
<span id="cb35-4"><a href="#cb35-4"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb35-5"><a href="#cb35-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># reglas del arbol</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>nombres <span class="op">=</span> <span class="bu">list</span>(X.columns)</span>
<span id="cb36-3"><a href="#cb36-3"></a>tree_rules <span class="op">=</span> export_text(md_tree, feature_names<span class="op">=</span>nombres)</span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="bu">print</span>(tree_rules)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>|--- petal length (cm) &lt;= 2.45
|   |--- class: 0
|--- petal length (cm) &gt;  2.45
|   |--- petal width (cm) &lt;= 1.75
|   |   |--- petal length (cm) &lt;= 5.35
|   |   |   |--- sepal length (cm) &lt;= 5.00
|   |   |   |   |--- petal width (cm) &lt;= 1.35
|   |   |   |   |   |--- class: 1
|   |   |   |   |--- petal width (cm) &gt;  1.35
|   |   |   |   |   |--- class: 2
|   |   |   |--- sepal length (cm) &gt;  5.00
|   |   |   |   |--- class: 1
|   |   |--- petal length (cm) &gt;  5.35
|   |   |   |--- class: 2
|   |--- petal width (cm) &gt;  1.75
|   |   |--- petal length (cm) &lt;= 4.85
|   |   |   |--- sepal width (cm) &lt;= 3.00
|   |   |   |   |--- class: 2
|   |   |   |--- sepal width (cm) &gt;  3.00
|   |   |   |   |--- class: 1
|   |   |--- petal length (cm) &gt;  4.85
|   |   |   |--- class: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># visualizaciÃ³n del Ã¡rbol</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>tree.plot_tree(md_tree, feature_names<span class="op">=</span>nombres, filled<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-5-2.png" width="960"></p>
</div>
</div>
</section></section>
<section>
<section id="k-nearest-neighbors-knn" class="title-slide slide level1 center" data-number="3">
<h1><span class="header-section-number">3</span> K Nearest Neighbors (KNN)</h1>

</section>
<section id="descripciÃ³n-del-algoritmo-knn" class="slide level2" data-number="3.1">
<h2><span class="header-section-number">3.1</span> DescripciÃ³n del algoritmo KNN</h2>
<ul>
<li>Es un algoritmo perezoso (âlazyâ) porque delega todo el cÃ¡lculo a la fase de clasicaciÃ³n (no hay propiamente una fase de construcciÃ³n del modelo)</li>
<li>Cuando se recibe una nueva instancia para clasificar se calcula la distancia a todas las instancias del conjunto de entrenamiento y nos quedamos con las k mÃ¡s cercanas</li>
<li>Se asigna la nueva clase a la instancia por votaciÃ³n</li>
<li>Se puede usar una ponderaciÃ³n en funciÃ³n de la inversa de la distancia</li>
</ul>
</section>
<section id="funcionamiento-de-knn" class="slide level2 smaller" data-number="3.2">
<h2><span class="header-section-number">3.2</span> Funcionamiento de KNN</h2>

<img data-src="images/image-1500538511.png" class="r-stretch"></section>
<section id="problemas-de-knn" class="slide level2 smaller" data-number="3.3">
<h2><span class="header-section-number">3.3</span> Problemas de KNN</h2>
<ul>
<li>Puede ser muy pesado de calcular si el nÃºmero de instancias del que aprendemos es muy grande</li>
<li>Si las caracterÃ­sticas tienen valores de Ã³rdenes de magnitud muy distintos, esto puede afectar a la capacidad de predicciÃ³n del algoritmo (es necesario preprocesamiento: normalizaciÃ³nâ¦)</li>
<li>Si el dataset estÃ¡ muy desbalanceado, puede ser difÃ­cil predecir la clase minoritaria por votaciÃ³n
<ul>
<li>Puede mejorarlo la asignaciÃ³n de pesos inversamente proporcionales a la distancia</li>
</ul></li>
</ul>
</section>
<section id="ejemplo-r-de-knn" class="slide level2 smaller" data-number="3.4">
<h2><span class="header-section-number">3.4</span> Ejemplo R de KNN</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="do">#############################################</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="do">## Knn</span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="do">#############################################</span></span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb39-6"><a href="#cb39-6"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb39-7"><a href="#cb39-7"></a>md_knn <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb39-8"><a href="#cb39-8"></a>                 <span class="at">data=</span>Xy_train, </span>
<span id="cb39-9"><a href="#cb39-9"></a>                 <span class="at">method=</span><span class="st">"knn"</span>, </span>
<span id="cb39-10"><a href="#cb39-10"></a>                 <span class="at">preProcess=</span><span class="st">"center"</span>,                </span>
<span id="cb39-11"><a href="#cb39-11"></a>                 <span class="at">trControl=</span>fitControl)</span>
<span id="cb39-12"><a href="#cb39-12"></a></span>
<span id="cb39-13"><a href="#cb39-13"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb39-14"><a href="#cb39-14"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_knn, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb39-15"><a href="#cb39-15"></a></span>
<span id="cb39-16"><a href="#cb39-16"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb39-17"><a href="#cb39-17"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb39-18"><a href="#cb39-18"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb41-3"><a href="#cb41-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         15         1
  virginica       0          0        14

Overall Statistics
                                          
               Accuracy : 0.9778          
                 95% CI : (0.8823, 0.9994)
    No Information Rate : 0.3333          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.9667          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            1.0000           0.9333
Specificity                 1.0000            0.9667           1.0000
Pos Pred Value              1.0000            0.9375           1.0000
Neg Pred Value              1.0000            1.0000           0.9677
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3333           0.3111
Detection Prevalence        0.3333            0.3556           0.3111
Balanced Accuracy           1.0000            0.9833           0.9667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_knn, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  setosa versicolor virginica
1      1          0         0
2      1          0         0
3      1          0         0
4      1          0         0
5      1          0         0
6      1          0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  1 1 1 1 1 1 1 1 1 1 ...
 $ versicolor  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ virginica   : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># curvas roc</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb47-4"><a href="#cb47-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb47-5"><a href="#cb47-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb47-6"><a href="#cb47-6"></a></span>
<span id="cb47-7"><a href="#cb47-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb47-9"><a href="#cb47-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb47-10"><a href="#cb47-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb47-11"><a href="#cb47-11"></a></span>
<span id="cb47-12"><a href="#cb47-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb47-13"><a href="#cb47-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb47-14"><a href="#cb47-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb47-15"><a href="#cb47-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb47-16"><a href="#cb47-16"></a></span>
<span id="cb47-17"><a href="#cb47-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-6-5.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-6-6.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-6-7.png" width="960"></p>
</div>
</div>
</section>
<section id="ejemplo-python-knn" class="slide level2 smaller" data-number="3.5">
<h2><span class="header-section-number">3.5</span> Ejemplo Python KNN</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="co">#############################################</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="co">## Knn</span></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="co">#############################################</span></span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="co"># construcciÃ³n del modelo</span></span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb50-9"><a href="#cb50-9"></a>md_knn <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb50-10"><a href="#cb50-10"></a>md_knn.fit(X_train_scaled, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-3 {color: black;background-color: white;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>y_pred <span class="op">=</span> md_knn.predict(X_test_scaled)</span>
<span id="cb51-3"><a href="#cb51-3"></a></span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0  9  1]
 [ 0  2 15]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.82      0.90      0.86        10
           2       0.94      0.88      0.91        17

    accuracy                           0.93        45
   macro avg       0.92      0.93      0.92        45
weighted avg       0.94      0.93      0.93        45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>y_test_proba_predict <span class="op">=</span> md_knn.predict_proba(X_test_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ejemplo-python-knn-2" class="slide level2 smaller" data-number="3.6">
<h2><span class="header-section-number">3.6</span> Ejemplo Python KNN 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># curva roc</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb56-5"><a href="#cb56-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="naive-bayes" class="title-slide slide level1 center" data-number="4">
<h1><span class="header-section-number">4</span> Naive Bayes</h1>

</section>
<section id="definiciÃ³n-del-problema" class="slide level2 smaller" data-number="4.1">
<h2><span class="header-section-number">4.1</span> DefiniciÃ³n del problema</h2>
<ul>
<li>En tÃ©rminos bayesianos el problema consiste:
<ul>
<li>Dadas unas caracterÃ­sticas x1, x2, â¦, xn</li>
<li>Predecir la etique y</li>
</ul></li>
<li>Una buena alternativa podrÃ­a ser usar el teorema de Bayes</li>
</ul>
<p><img data-src="images/image-447480413.png"></p>
<p><img data-src="images/image-431091592.png"></p>
</section>
<section id="asunciones" class="slide level2 smaller" data-number="4.2">
<h2><span class="header-section-number">4.2</span> Asunciones</h2>
<ul>
<li>SÃ³lo tenemos que calcular esta probabilidad y asignar la clase cuya probabilidad sea mayor</li>
<li>Â¿Problema? Calcular todas estas probabilidades es muy costoso (especialmente cuando el nÃºmero de caracterÃ­sticas aumenta)</li>
<li>Si asumimos que todas las variables son independientes entre sÃ­ se simplifican enÃ³rmemente los cÃ¡lculos</li>
</ul>

<img data-src="images/image-1694463182.png" class="r-stretch"></section>
<section id="ejemplo-r-de-naive-bayes" class="slide level2 smaller" data-number="4.3">
<h2><span class="header-section-number">4.3</span> Ejemplo R de Naive Bayes</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="do">#############################################</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="do">## NB</span></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="do">#############################################</span></span>
<span id="cb57-4"><a href="#cb57-4"></a></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'klaR'</span>)) <span class="fu">install.packages</span>(<span class="st">'klaR'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb57-6"><a href="#cb57-6"></a><span class="fu">library</span>(klaR)</span>
<span id="cb57-7"><a href="#cb57-7"></a></span>
<span id="cb57-8"><a href="#cb57-8"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb57-9"><a href="#cb57-9"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb57-10"><a href="#cb57-10"></a>md_nb <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb57-11"><a href="#cb57-11"></a>                 <span class="at">data=</span>Xy_train, </span>
<span id="cb57-12"><a href="#cb57-12"></a>                 <span class="at">method=</span><span class="st">"nb"</span>) </span>
<span id="cb57-13"><a href="#cb57-13"></a></span>
<span id="cb57-14"><a href="#cb57-14"></a></span>
<span id="cb57-15"><a href="#cb57-15"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb57-16"><a href="#cb57-16"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_nb, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb57-17"><a href="#cb57-17"></a></span>
<span id="cb57-18"><a href="#cb57-18"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb57-19"><a href="#cb57-19"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb57-20"><a href="#cb57-20"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb59-3"><a href="#cb59-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         13         2
  virginica       0          2        13

Overall Statistics
                                          
               Accuracy : 0.9111          
                 95% CI : (0.7878, 0.9752)
    No Information Rate : 0.3333          
    P-Value [Acc &gt; NIR] : 8.467e-16       
                                          
                  Kappa : 0.8667          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.8667           0.8667
Specificity                 1.0000            0.9333           0.9333
Pos Pred Value              1.0000            0.8667           0.8667
Neg Pred Value              1.0000            0.9333           0.9333
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.2889           0.2889
Detection Prevalence        0.3333            0.3333           0.3333
Balanced Accuracy           1.0000            0.9000           0.9000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_nb, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   setosa   versicolor    virginica
1       1 8.913737e-20 5.114392e-26
2       1 5.579668e-19 1.479600e-25
6       1 4.863540e-15 3.122673e-21
16      1 2.530442e-17 8.535073e-23
18      1 1.430512e-18 9.289533e-25
20      1 1.073394e-18 9.081692e-25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  1 1 1 1 1 ...
 $ versicolor  : num  8.91e-20 5.58e-19 4.86e-15 2.53e-17 1.43e-18 ...
 $ virginica   : num  5.11e-26 1.48e-25 3.12e-21 8.54e-23 9.29e-25 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># curvas roc</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb65-4"><a href="#cb65-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb65-5"><a href="#cb65-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb65-6"><a href="#cb65-6"></a></span>
<span id="cb65-7"><a href="#cb65-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb65-8"><a href="#cb65-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb65-9"><a href="#cb65-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb65-10"><a href="#cb65-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb65-11"><a href="#cb65-11"></a></span>
<span id="cb65-12"><a href="#cb65-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb65-13"><a href="#cb65-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb65-14"><a href="#cb65-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb65-15"><a href="#cb65-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb65-16"><a href="#cb65-16"></a></span>
<span id="cb65-17"><a href="#cb65-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-9-3.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-9-4.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ejemplo-python-naive-bayes" class="slide level2 smaller" data-number="4.4">
<h2><span class="header-section-number">4.4</span> Ejemplo Python Naive Bayes</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a><span class="co">#############################################</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="co">## NB</span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="co">#############################################</span></span>
<span id="cb68-4"><a href="#cb68-4"></a></span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="co"># construcciÃ³n del modelo</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb68-7"><a href="#cb68-7"></a></span>
<span id="cb68-8"><a href="#cb68-8"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb68-9"><a href="#cb68-9"></a>md_nb <span class="op">=</span> GaussianNB()</span>
<span id="cb68-10"><a href="#cb68-10"></a>md_nb.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-4 {color: black;background-color: white;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked=""><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>y_pred <span class="op">=</span> md_nb.predict(X_test)</span>
<span id="cb69-3"><a href="#cb69-3"></a></span>
<span id="cb69-4"><a href="#cb69-4"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb69-5"><a href="#cb69-5"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0 10  0]
 [ 0  2 15]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.83      1.00      0.91        10
           2       1.00      0.88      0.94        17

    accuracy                           0.96        45
   macro avg       0.94      0.96      0.95        45
weighted avg       0.96      0.96      0.96        45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb73-3"><a href="#cb73-3"></a>y_test_proba_predict <span class="op">=</span> md_tree.predict_proba(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ejemplo-python-naive-bayes-2" class="slide level2 smaller" data-number="4.5">
<h2><span class="header-section-number">4.5</span> Ejemplo Python Naive Bayes 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># curva roc</span></span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb74-3"><a href="#cb74-3"></a></span>
<span id="cb74-4"><a href="#cb74-4"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb74-5"><a href="#cb74-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="support-vector-machines-svm" class="title-slide slide level1 center" data-number="5">
<h1><span class="header-section-number">5</span> Support Vector Machines (SVM)</h1>

</section>
<section id="descripciÃ³n-del-mÃ©todo" class="slide level2 smaller" data-number="5.1">
<h2><span class="header-section-number">5.1</span> DescripciÃ³n del mÃ©todo</h2>
<ul>
<li>El problema de clasificaciÃ³n consiste en encontrar un hiperplano que separe las instancias de distintas clases</li>
<li>Â¿QuÃ© hiperplano seleccionamos?</li>
<li>El algoritmo SVM intenta encontrar la separaciÃ³n Ã³ptima
<ul>
<li>AquÃ©lla que maximiza la distancia entre el hiperplano y los puntos âcomplicadosâ llamados support vectors. Es un problema cuadrÃ¡tico</li>
</ul></li>
</ul>

<img data-src="images/image-1899789080.png" class="r-stretch"></section>
<section id="svm-representaciÃ³n-grÃ¡fica" class="slide level2" data-number="5.2">
<h2><span class="header-section-number">5.2</span> SVM representaciÃ³n grÃ¡fica</h2>

<img data-src="images/image-1434379904.png" class="r-stretch"></section>
<section id="el-truco-del-kernel" class="slide level2 smaller" data-number="5.3">
<h2><span class="header-section-number">5.3</span> El truco del kernel</h2>
<ul>
<li>Los SVMs funcionan muy bien si la separaciÃ³n entre clases es lineal</li>
</ul>
<p><img data-src="images/image-259188054.png"></p>
<ul>
<li>Â¿QuÃ© ocurre si esta separaciÃ³n es mÃ¡s compleja?</li>
</ul>
<p><img data-src="images/image-337776540.png"></p>
<ul>
<li>Podemos intentar transformar el espacio en otro de mayor dimensionalidad donde las clases sÃ­ sean separables linealmente</li>
</ul>
<p><img data-src="images/image-1668756719.png"></p>
</section>
<section id="el-truco-del-kernel-2" class="slide level2 smaller" data-number="5.4">
<h2><span class="header-section-number">5.4</span> El truco del kernel 2</h2>
<ul>
<li>Idea general: Siempre podemos encontrar una transformaciÃ³n del espacio original a un espacio de mÃ¡s dimensiones donde los datos de aprendizaje son separables</li>
</ul>

<img data-src="images/image-1920754441.png" class="r-stretch"></section>
<section id="kernels-tÃ­picos" class="slide level2" data-number="5.5">
<h2><span class="header-section-number">5.5</span> Kernels tÃ­picos</h2>
<ul>
<li>Existen distintos tipos de kernels, adecuados para distintos tipos de problemas:</li>
</ul>

<img data-src="images/image-1410071433.png" class="r-stretch"></section>
<section id="importancia-de-los-parÃ¡metros-gamma" class="slide level2 smaller" data-number="5.6">
<h2><span class="header-section-number">5.6</span> Importancia de los parÃ¡metros: gamma</h2>

<img data-src="images/image-161779551.png" class="r-stretch"></section>
<section id="importancia-de-los-parÃ¡metros-coste" class="slide level2 smaller" data-number="5.7">
<h2><span class="header-section-number">5.7</span> Importancia de los parÃ¡metros: coste</h2>

<img data-src="images/image-205258487.png" class="r-stretch"></section>
<section id="ejemplo-r-de-svm" class="slide level2 smaller" data-number="5.8">
<h2><span class="header-section-number">5.8</span> Ejemplo R de SVM</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="do">#############################################</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="do">## svm</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="do">#############################################</span></span>
<span id="cb75-4"><a href="#cb75-4"></a></span>
<span id="cb75-5"><a href="#cb75-5"></a><span class="co"># librerÃ­as del modelo</span></span>
<span id="cb75-6"><a href="#cb75-6"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'e1071'</span>)) <span class="fu">install.packages</span>(<span class="st">'e1071'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="fu">library</span>(e1071)</span>
<span id="cb75-8"><a href="#cb75-8"></a></span>
<span id="cb75-9"><a href="#cb75-9"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb75-10"><a href="#cb75-10"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb75-11"><a href="#cb75-11"></a>md_svm <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb75-12"><a href="#cb75-12"></a>                <span class="at">data=</span>Xy_train, </span>
<span id="cb75-13"><a href="#cb75-13"></a>                <span class="at">method=</span><span class="st">"svmRadial"</span>, </span>
<span id="cb75-14"><a href="#cb75-14"></a>                <span class="at">preProcess=</span><span class="st">"center"</span>,</span>
<span id="cb75-15"><a href="#cb75-15"></a>                <span class="at">trControl=</span>fitControl)</span>
<span id="cb75-16"><a href="#cb75-16"></a></span>
<span id="cb75-17"><a href="#cb75-17"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb75-18"><a href="#cb75-18"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_svm, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb75-19"><a href="#cb75-19"></a></span>
<span id="cb75-20"><a href="#cb75-20"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb75-21"><a href="#cb75-21"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb75-22"><a href="#cb75-22"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb77-2"><a href="#cb77-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb77-3"><a href="#cb77-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         14         2
  virginica       0          1        13

Overall Statistics
                                         
               Accuracy : 0.9333         
                 95% CI : (0.8173, 0.986)
    No Information Rate : 0.3333         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.9            
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.9333           0.8667
Specificity                 1.0000            0.9333           0.9667
Pos Pred Value              1.0000            0.8750           0.9286
Neg Pred Value              1.0000            0.9655           0.9355
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3111           0.2889
Detection Prevalence        0.3333            0.3556           0.3111
Balanced Accuracy           1.0000            0.9333           0.9167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_svm, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     setosa  versicolor   virginica
1 0.9844997 0.006167946 0.009332391
2 0.9734873 0.010751658 0.015761039
3 0.9760596 0.009327093 0.014613356
4 0.6205678 0.120784442 0.258647718
5 0.9850896 0.005930823 0.008979593
6 0.9788745 0.008280152 0.012845364</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  0.984 0.973 0.976 0.621 0.985 ...
 $ versicolor  : num  0.00617 0.01075 0.00933 0.12078 0.00593 ...
 $ virginica   : num  0.00933 0.01576 0.01461 0.25865 0.00898 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># curvas roc</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb83-4"><a href="#cb83-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb83-5"><a href="#cb83-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb83-6"><a href="#cb83-6"></a></span>
<span id="cb83-7"><a href="#cb83-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb83-8"><a href="#cb83-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb83-9"><a href="#cb83-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb83-10"><a href="#cb83-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb83-11"><a href="#cb83-11"></a></span>
<span id="cb83-12"><a href="#cb83-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb83-13"><a href="#cb83-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb83-14"><a href="#cb83-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb83-15"><a href="#cb83-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb83-16"><a href="#cb83-16"></a></span>
<span id="cb83-17"><a href="#cb83-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-12-3.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-12-4.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-12-5.png" width="960"></p>
</div>
</div>
</section>
<section id="ejemplo-python-svm" class="slide level2 smaller" data-number="5.9">
<h2><span class="header-section-number">5.9</span> Ejemplo Python SVM</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a><span class="co">#############################################</span></span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="co">## SVM</span></span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="co">#############################################</span></span>
<span id="cb86-4"><a href="#cb86-4"></a></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="co"># construcciÃ³n del modelo</span></span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb86-7"><a href="#cb86-7"></a></span>
<span id="cb86-8"><a href="#cb86-8"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb86-9"><a href="#cb86-9"></a>md_svm <span class="op">=</span> SVC(probability<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb86-10"><a href="#cb86-10"></a>md_svm.fit(X_train_scaled, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-5 {color: black;background-color: white;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVC(probability=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked=""><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">SVC</label><div class="sk-toggleable__content"><pre>SVC(probability=True)</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>y_pred <span class="op">=</span> md_svm.predict(X_test_scaled)</span>
<span id="cb87-3"><a href="#cb87-3"></a></span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0 10  0]
 [ 0  2 15]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.83      1.00      0.91        10
           2       1.00      0.88      0.94        17

    accuracy                           0.96        45
   macro avg       0.94      0.96      0.95        45
weighted avg       0.96      0.96      0.96        45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a></span>
<span id="cb91-2"><a href="#cb91-2"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>y_test_proba_predict <span class="op">=</span> md_svm.predict_proba(X_test_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ejemplo-python-svm-2" class="slide level2 smaller" data-number="5.10">
<h2><span class="header-section-number">5.10</span> Ejemplo Python SVM 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a><span class="co"># curva roc</span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb92-3"><a href="#cb92-3"></a></span>
<span id="cb92-4"><a href="#cb92-4"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb92-5"><a href="#cb92-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="redes-neuronales-artificiales-artificial-neural-networks-ann" class="title-slide slide level1 center" data-number="6">
<h1><span class="header-section-number">6</span> Redes neuronales artificiales (artificial neural networks, ANN)</h1>

</section>
<section id="introducciÃ³n-1" class="slide level2 smaller" data-number="6.1">
<h2><span class="header-section-number">6.1</span> IntroducciÃ³n</h2>
<ul>
<li>Son un tipo de algoritmos perteneciente al campo del ML que intenta simular el comportamiento de las redes de neuronas biolÃ³gicas</li>
<li>Se remontan a los aÃ±os 40, aunque su desarrollo estuvo parado durante casi dos dÃ©cadas</li>
<li>Muy populares durante los 80 y 90 aunque su uso cayÃ³ en la Ãºltima dÃ©cada</li>
<li>De nuevo son actualidad debido a su uso en el Deep Learning</li>
</ul>
</section>
<section id="investigadores-relevantes" class="slide level2 smaller" data-number="6.2">
<h2><span class="header-section-number">6.2</span> Investigadores relevantes</h2>

<img data-src="images/image-padres-dl.png" class="r-stretch"><p><a href="https://www.datarobot.com/blog/a-primer-on-deep-learning/" class="uri">https://www.datarobot.com/blog/a-primer-on-deep-learning/</a></p>
</section>
<section id="un-poco-de-mÃ¡s-historia" class="slide level2 smaller" data-number="6.3">
<h2><span class="header-section-number">6.3</span> Un poco de mÃ¡s historia</h2>
<ul>
<li>1943: McCulloch-Pitts definen la âneurona artificialâ.
<ul>
<li>Comienzo del campo</li>
</ul></li>
<li>1962: Rosenblatt introduce el perceptrÃ³n
<ul>
<li>Aprende los pesos de las conexiones, prueba la convergencia</li>
</ul></li>
<li>1969: Minsky y Papert publican un libro sobre el perceptrÃ³n
<ul>
<li>Prueban las limitaciones de los perceptrones de una capa</li>
</ul></li>
<li>1986: Backpropagation del error
<ul>
<li>Vuelta a la actualidad de las ANNs. MÃ©todo para entrenar redes multicapa</li>
</ul></li>
<li>Actualidad: Gran nÃºmero de neuronas y capas con gran capacidad de aprendizaje, son la base entre otras aplicaciones de los Grandes Modelos de Lenguaje (ChatGPTâ¦)
<ul>
<li>Deep Learning</li>
</ul></li>
</ul>
</section>
<section id="caracterÃ­sticas-de-las-redes-neuronales-biolÃ³gicas" class="slide level2 smaller" data-number="6.4">
<h2><span class="header-section-number">6.4</span> CaracterÃ­sticas de las redes neuronales biolÃ³gicas</h2>
<ul>
<li>Conectividad masiva (10^14 conexiones)</li>
<li>No-lineales, paralelas, robustas y tolerantes a fallos</li>
<li>Capaces de adaptarse al entorno</li>
<li>Capaces de aprender y generalizar a partir de ejemplos conocidos</li>
<li>Comportamiento colectivo emergente distinto del comportamiento individual</li>
</ul>
<p>Las Redes de ANNs tratan de imitar algunas de estas caracterÃ­sticasâ¦</p>
</section>
<section id="caracterÃ­sticas-de-las-anns" class="slide level2 smaller" data-number="6.5">
<h2><span class="header-section-number">6.5</span> CaracterÃ­sticas de las ANNs</h2>
<ul>
<li>Formadas por unidades de cÃ³mputo sencillas</li>
<li>La informaciÃ³n se almacena en las conexiones =&gt; No hay memoria como tal</li>
<li>Masivamente paralelas</li>
<li>Masivamente interconectadas</li>
<li>Tolerantes a fallos</li>
<li>Capaces de aprender y generalizar a partir de ejemplos</li>
<li>Robustas</li>
<li>Comportamiento colectivo diferente del comportamiento individual</li>
</ul>
<p>Dependiendo del modelo de ANN que usemos, algunas caracterÃ­sticas pueden no estar disponibles</p>
</section>
<section id="perceptrÃ³n-de-una-capa" class="slide level2 smaller" data-number="6.6">
<h2><span class="header-section-number">6.6</span> PerceptrÃ³n de una capa</h2>
<ul>
<li>La mÃ¡s sencilla de las ANN</li>
<li>Una capa de neuronas que reciben los atributos de entrada
<ul>
<li>Cada neurona tiene un peso asociado</li>
</ul></li>
<li>Son agregados por medio de una funciÃ³n de activaciÃ³n</li>
</ul>

<img data-src="images/image-rna-01.png" class="r-stretch"></section>
<section id="funciÃ³n-de-activaciÃ³n-threshold-o-escalÃ³n" class="slide level2 smaller" data-number="6.7">
<h2><span class="header-section-number">6.7</span> FunciÃ³n de activaciÃ³n threshold o escalÃ³n</h2>
<p>Asigna el valor 1 a lo que quede a un lado de la frontera de separaciÃ³n y -1 a lo que quede al otro lado</p>

<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-15-3.png" width="960" class="r-stretch"></section>
<section id="funciÃ³n-de-activaciÃ³n-lineal" class="slide level2 smaller" data-number="6.8">
<h2><span class="header-section-number">6.8</span> FunciÃ³n de activaciÃ³n lineal</h2>

<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="funciÃ³n-de-activaciÃ³n-sigmoide" class="slide level2 smaller" data-number="6.9">
<h2><span class="header-section-number">6.9</span> FunciÃ³n de activaciÃ³n Sigmoide</h2>

<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="funciÃ³n-de-activaciÃ³n-tangente-hiperbÃ³lica" class="slide level2 smaller" data-number="6.10">
<h2><span class="header-section-number">6.10</span> FunciÃ³n de activaciÃ³n Tangente HiperbÃ³lica</h2>

<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="funciÃ³n-de-activaciÃ³n-relu" class="slide level2 smaller" data-number="6.11">
<h2><span class="header-section-number">6.11</span> FunciÃ³n de activaciÃ³n Relu</h2>

<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-19-1.png" width="960" class="r-stretch"></section>
<section id="perceptrÃ³n-de-una-capa.-bias" class="slide level2 smaller" data-number="6.12">
<h2><span class="header-section-number">6.12</span> PerceptrÃ³n de una capa. Bias</h2>

<img data-src="images/image-rna-02.png" class="r-stretch"></section>
<section id="justificaciÃ³n-del-bias" class="slide level2 smaller" data-number="6.13">
<h2><span class="header-section-number">6.13</span> JustificaciÃ³n del bias</h2>
<ul>
<li>Para convertir entre Celsius y Fahrenheit, tenemos un problema, porque a 0ÂºC le corresponden 32ÂºF, y sÃ³lo con una multiplicaciÃ³n no podemos hacer esto. Sin embargo, al introducir el tÃ©rmino Bias, tenemos una multiplicaciÃ³n y luego una suma, con lo cual ya podrÃ­amos hacer el conversor de c (variable x) a f (variable y)</li>
</ul>
<p><span class="math display">\[ f = c \times 1.8 + 32 \]</span> <span class="math display">\[ y = x \times 1.8 + 1 \times 32 \]</span></p>

<img data-src="images/image-celsius.png" class="r-stretch"></section>
<section id="probando-el-perceptrÃ³n-con-tensorflow-en-python-para-regresiÃ³n" class="slide level2 smaller" data-number="6.14">
<h2><span class="header-section-number">6.14</span> Probando el perceptrÃ³n con Tensorflow en Python para regresiÃ³n</h2>
<iframe src="nb/IA_M01_00_ANN.html" width="100%" height="499">
</iframe>
</section>
<section id="perceptrÃ³n-de-una-capa.-simplificando-notaciÃ³n" class="slide level2 smaller" data-number="6.15">
<h2><span class="header-section-number">6.15</span> PerceptrÃ³n de una capa. Simplificando notaciÃ³n</h2>

<img data-src="images/image-rna-03.png" class="r-stretch"></section>
<section id="perceptrÃ³n-de-una-capa-con-solo-dos-variables-de-entrada" class="slide level2 smaller" data-number="6.16">
<h2><span class="header-section-number">6.16</span> PerceptrÃ³n de una capa con solo dos variables de entrada</h2>

<img data-src="images/image-rna-04.png" class="r-stretch"><ul>
<li>Este perceptrÃ³n (que usala funciÃ³n sigmoidal) puede clasificar basÃ¡ndose en una <strong>recta</strong></li>
<li>Si usamos tensorflow (tf):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a>capa <span class="op">=</span> tf.keras.layers.Dense(units<span class="op">=</span><span class="dv">1</span>, input_dim<span class="op">=</span><span class="dv">2</span>,  activation<span class="op">=</span><span class="st">'sigmoid'</span>)</span>
<span id="cb93-2"><a href="#cb93-2"></a>model <span class="op">=</span> tf.keras.Sequential([capa])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pongamos-a-prueba-el-perceptrÃ³n-para-una-estrategia-relacional" class="slide level2 smaller" data-number="6.17">
<h2><span class="header-section-number">6.17</span> Pongamos a prueba el perceptrÃ³n para una estrategia relacional</h2>

<img data-src="images/image-estrategia-rel.png" class="r-stretch"><ul>
<li>Nuestro banco quiere hacer una campaÃ±a de prÃ©stamos personales</li>
<li>Vamos a seleccionar el pÃºblico objetivo mediante un perceptrÃ³n</li>
<li>Nos basaremos en los resultados de campaÃ±as histÃ³ricas sobre el mismo producto</li>
</ul>
</section>
<section id="obtenciÃ³n-de-los-datos-de-entrenamiento-para-el-perceptrÃ³n" class="slide level2 smaller" data-number="6.18">
<h2><span class="header-section-number">6.18</span> ObtenciÃ³n de los datos de entrenamiento para el perceptrÃ³n</h2>

<img data-src="images/image-crm.png" class="r-stretch"><ul>
<li>Obtenemos la tabla de entrenamiento (XY) a partir de aquellos clientes que se les ofreciÃ³ anteriormente el prÃ©stamo:
<ul>
<li>y: es la respuesta del cliente (1:contratÃ³, 0:no)</li>
<li>x1,â¦,xn: son las variables que reflejan la situaciÃ³n del cliente en el momento de esa respuesta (edad, saldos, gastosâ¦)</li>
</ul></li>
</ul>
</section>
<section id="primer-caso-or" class="slide level2 smaller" data-number="6.19">
<h2><span class="header-section-number">6.19</span> Primer caso: OR</h2>
<ul>
<li>Supongamos que hemos obtenido la siguiente tabla para los 4 clientes del banco:</li>
</ul>
<table>
<thead>
<tr class="header">
<th>id</th>
<th>x1</th>
<th>x2</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<ul>
<li><p>donde:</p>
<ul>
<li><strong>x1</strong>: tarjeta de crÃ©dito (0:no, 1:sÃ­)</li>
<li><strong>x2</strong>: otros prÃ©stamos personales (0:no, 1:sÃ­)</li>
<li><strong>y</strong>: contratÃ³ crÃ©dito personal cuando se lo ofreciÃ³ (0:no, 1:sÃ­)</li>
</ul></li>
</ul>
</section>
<section id="resoluciÃ³n-del-primer-caso-con-tensorflow" class="slide level2 smaller" data-number="6.20">
<h2><span class="header-section-number">6.20</span> ResoluciÃ³n del primer caso con tensorflow</h2>
<iframe src="nb/IA_M01_01_ANN.html" width="100%" height="499">
</iframe>
</section>
<section id="segundo-caso-and" class="slide level2 smaller" data-number="6.21">
<h2><span class="header-section-number">6.21</span> Segundo caso: AND</h2>
<ul>
<li>Supongamos que hemos obtenido la siguiente tabla para los 4 clientes del banco:</li>
</ul>
<table>
<thead>
<tr class="header">
<th>id</th>
<th>x1</th>
<th>x2</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<ul>
<li><p>donde:</p>
<ul>
<li><strong>x1</strong>: joven (0:no, 1:sÃ­)</li>
<li><strong>x2</strong>: nÃ³mina (0:no, 1:sÃ­)</li>
<li><strong>y</strong>: contratÃ³ crÃ©dito personal cuando se lo ofreciÃ³ (0:no, 1:sÃ­)</li>
</ul></li>
</ul>
</section>
<section id="resoluciÃ³n-del-segundo-caso-con-tensorflow" class="slide level2 smaller" data-number="6.22">
<h2><span class="header-section-number">6.22</span> ResoluciÃ³n del segundo caso con tensorflow</h2>
<iframe src="nb/IA_M01_02_ANN.html" width="100%" height="499">
</iframe>
</section>
<section id="tercer-caso-xor" class="slide level2 smaller" data-number="6.23">
<h2><span class="header-section-number">6.23</span> Tercer caso: XOR</h2>
<ul>
<li>Supongamos que hemos obtenido la siguiente tabla para los 4 clientes del banco:</li>
</ul>
<table>
<thead>
<tr class="header">
<th>id</th>
<th>x1</th>
<th>x2</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<ul>
<li><p>donde:</p>
<ul>
<li><strong>x1</strong>: tarjeta crÃ©dito (0:no, 1:sÃ­)</li>
<li><strong>x2</strong>: pÃ³liza crÃ©dito (0:no, 1:sÃ­)</li>
<li><strong>y</strong>: contratÃ³ crÃ©dito personal cuando se lo ofreciÃ³ (0:no, 1:sÃ­)</li>
</ul></li>
</ul>
</section>
<section id="resoluciÃ³n-del-tercer-caso-con-tensorflow-1-neurona" class="slide level2 smaller" data-number="6.24">
<h2><span class="header-section-number">6.24</span> ResoluciÃ³n del tercer caso con tensorflow 1 neurona</h2>
<iframe src="nb/IA_M01_03_ANN.html" width="100%" height="499">
</iframe>
</section>
<section id="perceptrÃ³n-de-una-capa-clasificaciÃ³n" class="slide level2 smaller" data-number="6.25">
<h2><span class="header-section-number">6.25</span> PerceptrÃ³n de una capa: clasificaciÃ³n</h2>
<ul>
<li>Si los datos de aprendizaje son linealmente separables entonces, usando un algoritmo de aprendizaje correcto, se puede conseguir un ratio de clasificaciÃ³n perfecto</li>
</ul>

<img data-src="images/image-531864042.png" class="r-stretch"></section>
<section id="cÃ³mo-se-optimiza-el-vector-de-pesos" class="slide level2 smaller" data-number="6.26">
<h2><span class="header-section-number">6.26</span> CÃ³mo se optimiza el vector de pesos</h2>
<ul>
<li>Podemos usar un mÃ©todo clÃ¡sico como es el Descenso del Gradiente (GD, por sus siglas en inglÃ©s)</li>
<li>Este algoritmo requiere de una funciÃ³n de coste E(|w|) que permita al algoritmo estimar la mejora esperada al actualizar el vector de pesos</li>
<li>El algoritmo funciona de manera iterativa, actualizando cada vez el vector w en funciÃ³n de los resultados del paso anterior</li>
</ul>
</section>
<section id="funciÃ³n-de-coste-en-el-perceptrÃ³n" class="slide level2" data-number="6.27">
<h2><span class="header-section-number">6.27</span> FunciÃ³n de coste en el perceptrÃ³n</h2>
<ul>
<li>El objetivo del perceptrÃ³n cuando lo usamos para clasificaciÃ³n es minimizar el nÃºmero de instancias mal clasificadas</li>
<li>Nuestra funciÃ³n de coste tomarÃ¡ en cuenta la suma de las distancias de aquellas instancias mal clasicadas</li>
</ul>
</section>
<section id="introducciÃ³n-a-la-no-separabilidad-lineal" class="slide level2 smaller" data-number="6.28">
<h2><span class="header-section-number">6.28</span> IntroducciÃ³n a la no separabilidad lineal</h2>
<p>Â¿QuÃ© ocurre en casos como el de la imagen?</p>
<ul>
<li>NecesitarÃ­amos trazar una frontera mÃ¡s complejas</li>
<li>Dos rectas podrÃ­an ser la soluciÃ³n para este problema del XOR</li>
</ul>

<img data-src="images/image-1062467727.png" class="r-stretch"></section>
<section id="el-problema-del-xor" class="slide level2 smaller" data-number="6.29">
<h2><span class="header-section-number">6.29</span> El problema del XOR</h2>
<ul>
<li>La lÃ³gica digital se base en tres funciones: AND, OR y NOT</li>
<li>El XOR se puede formular como: XOR(X1, X2) = (X1 AND (NOT X2)) OR ((NOT X1) AND X2)</li>
<li>Ya hemos solucionado el AND y el OR con una neurona</li>
<li>Idea Â¿y si aÃ±adimos mÃ¡s neuronales al perceptrÃ³n?</li>
</ul>

<img data-src="images/image-xor-log.png" class="r-stretch"></section>
<section id="soluciÃ³n-al-problema-del-xor" class="slide level2 smaller" data-number="6.30">
<h2><span class="header-section-number">6.30</span> SoluciÃ³n al problema del XOR</h2>
<ul>
<li>Necesitamos una versiÃ³n mÃ¡s sofisticada del perceptrÃ³n:</li>
<li>Podemos aÃ±adir una nueva capa <strong>oculta</strong> con dos neuronas para ver si aprenden a <em>descomponer</em> el XOR en sus distintas puertas lÃ³gicas</li>
</ul>
<p><img data-src="images/image-xor.png"> <a href="https://www.danli.org/2021/06/21/hands-on-machine-learning-keras/" class="uri">https://www.danli.org/2021/06/21/hands-on-machine-learning-keras/</a></p>
</section>
<section id="soluciÃ³n-al-problema-de-clases-no-linealmente-separables" class="slide level2 smaller" data-number="6.31">
<h2><span class="header-section-number">6.31</span> SoluciÃ³n al problema de clases no linealmente separables</h2>
<ul>
<li>Necesitamos una versiÃ³n mÃ¡s sofisticada del perceptrÃ³n:
<ul>
<li>PerceptrÃ³n Multicapa (MLP) + error backprogation</li>
<li>TambiÃ©n puede ayudar otras funciones de activaciÃ³n</li>
</ul></li>
</ul>
</section>
<section id="resoluciÃ³n-del-tercer-caso-con-tensorflow-aÃ±adiendo-una-capa-oculta" class="slide level2 smaller" data-number="6.32">
<h2><span class="header-section-number">6.32</span> ResoluciÃ³n del tercer caso con tensorflow aÃ±adiendo una capa oculta</h2>
<iframe src="nb/IA_M01_04_ANN.html" width="100%" height="499">
</iframe>
</section>
<section id="problema-del-xor-solucionado" class="slide level2 smaller" data-number="6.33">
<h2><span class="header-section-number">6.33</span> Problema del XOR solucionado</h2>
<ul>
<li>Con esta arquitectura y funciÃ³n de activaciÃ³n parece solucionado el problema del XOR</li>
</ul>

<img data-src="images/image-xor-ann.png" class="r-stretch"></section>
<section id="generalizando-el-problema-del-xor" class="slide level2 smaller" data-number="6.34">
<h2><span class="header-section-number">6.34</span> Generalizando el problema del XOR</h2>
<ul>
<li>Podemos generalizar el problema del XOR con valores continuos (no solo con valores 0 y 1 para las variables de entrada)</li>
<li>En nuestro caso 3, tendrÃ­amos ahora:</li>
<li>x1: consumo en â¬ tarjetas de crÃ©dito del cliente</li>
<li>x2: consumo en â¬ pÃ³lizas de crÃ©dito del cliente</li>
</ul>

<img data-src="images/image-xor-gen.png" class="r-stretch"></section>
<section id="juguemos-a-resolver-el-problema-del-xor" class="slide level2 smaller" data-number="6.35">
<h2><span class="header-section-number">6.35</span> Juguemos a resolver el problema del XOR</h2>
<p><a href="https://playground.tensorflow.org/#activation=sigmoid&amp;batchSize=10&amp;dataset=xor&amp;regDataset=reg-plane&amp;learningRate=0.03&amp;regularizationRate=0&amp;noise=0&amp;networkShape=2&amp;seed=0.79208&amp;showTestData=false&amp;discretize=true&amp;percTrainData=50&amp;x=true&amp;y=true&amp;xTimesY=false&amp;xSquared=false&amp;ySquared=false&amp;cosX=false&amp;sinX=false&amp;cosY=false&amp;sinY=false&amp;collectStats=false&amp;problem=classification&amp;initZero=false&amp;hideText=false">Playground XOR</a></p>

<img data-src="images/image-xor-play.png" class="r-stretch"><ul>
<li>Probemos otras funciones de activaciÃ³n y topologÃ­as</li>
</ul>
</section>
<section id="perceptrÃ³n-multicapa-mlp" class="slide level2 smaller" data-number="6.36">
<h2><span class="header-section-number">6.36</span> PerceptrÃ³n Multicapa (MLP)</h2>
<ul>
<li>AmplÃ­a el original aÃ±adiendo capas intermedias de neuronas
<ul>
<li>Una o mÃ¡s capas</li>
</ul></li>
<li>Dependiendo del nÃºmero de capas (y de la funciÃ³n de activaciÃ³n) podemos conseguir fronteras de decisiÃ³n de mayor o menor complejidad</li>
<li>Si hay muchas capas hablamos de aprendizaje profundo (deep learning)</li>
<li>En el MLP para clasificaciÃ³n siempre las capas de entrada y salida estÃ¡n definidas por el conjunto de datos XY:
<ul>
<li>x1,â¦,xn: n entradas (nÃºmero de variables independientes)</li>
<li>{y1,â¦,ym}: son los posibles valores de la clase objetivo</li>
</ul></li>
</ul>
</section>
<section id="perceptrÃ³n-multicapa-arquitectura" class="slide level2 smaller" data-number="6.37">
<h2><span class="header-section-number">6.37</span> PerceptrÃ³n Multicapa Arquitectura</h2>

<img data-src="images/image-mlp.png" class="r-stretch"></section>
<section id="posibles-fronteras-de-decisiÃ³n" class="slide level2 smaller" data-number="6.38">
<h2><span class="header-section-number">6.38</span> Posibles fronteras de decisiÃ³n</h2>
<ul>
<li>Si usamos una funciÃ³n de activaciÃ³n de tipo threshold, podemos tener las siguientes fronteras:
<ul>
<li>Una capa: lÃ­nea/hiperplano</li>
<li>Dos capas: superficie convexa</li>
<li>Tres capas: fronteras arbitrarias</li>
</ul></li>
</ul>

<img data-src="images/image-89817222.png" class="r-stretch"><ul>
<li>Con una funciÃ³n de activaciÃ³n sigmoidea podemos conseguir fronteras arbitrarias con sÃ³lo dos capas</li>
</ul>
</section>
<section id="soluciÃ³n-al-problema-del-xor-1" class="slide level2 smaller" data-number="6.39">
<h2><span class="header-section-number">6.39</span> SoluciÃ³n al problema del xor</h2>

<img data-src="images/image-2096173787.png" class="r-stretch"></section>
<section id="entrenando-mlp" class="slide level2" data-number="6.40">
<h2><span class="header-section-number">6.40</span> Entrenando MLP</h2>
<ul>
<li>En el caso de los MLPs, el aprendizaje se divide en dos partes
<ul>
<li>Por un lado, tenemos una primera pasada (forward pass) que calcula la salida a partir de la entrada, pasando por todas las capas intermedias</li>
<li>Por otro lado, tenemos una segunda pasada (error backpropagation) donde se ajustan los pesos de todos los arcos</li>
</ul></li>
<li>La primera fase es una extensiÃ³n de lo que hacÃ­amos anteriormente. Veamos la segundaâ¦</li>
</ul>
</section>
<section id="algoritmo-backpropagation" class="slide level2 smaller" data-number="6.41">
<h2><span class="header-section-number">6.41</span> Algoritmo backpropagation</h2>
<ul>
<li>DescripciÃ³n:
<ul>
<li>Tras inicializar los pesos de forma aleatoria y con valores pequeÃ±os, seleccionamos el primer par de entrenamiento.</li>
<li>Calculamos la salida de la red</li>
<li>Calculamos la diferencia entre la salida real de la red y la salida deseada, con lo que obtenemos el vector de error</li>
<li>Ajustamos los pesos de la red de forma que se minimice el error</li>
<li>Repetimos los tres pasos anteriores para cada par de entrenamiento hasta que el error para todos los conjuntos de entrenamiento sea aceptable.</li>
<li>Para cada entrenamiento mÃºltiple Â«epochsÂ» (conjuntos de entrenamiento)</li>
</ul></li>
</ul>
</section>
<section id="algoritmo-backpropagation-2" class="slide level2 smaller" data-number="6.42">
<h2><span class="header-section-number">6.42</span> Algoritmo backpropagation 2</h2>

<img data-src="images/image-1543861572.png" class="r-stretch"></section>
<section id="algunas-consideraciones-sobre-los-mlp" class="slide level2" data-number="6.43">
<h2><span class="header-section-number">6.43</span> Algunas consideraciones sobre los MLP</h2>
<ul>
<li>Al usar Gradient Descent, necesitamos calcular la derivada de la funciÃ³n de coste</li>
<li>Es conveniente normalizar los datos de entrada para agilizar los cÃ¡lculos</li>
<li>RegularizaciÃ³n: AÃ±ade una penalizaciÃ³n a valores de W altos</li>
</ul>
</section>
<section id="teorema-de-cybenko" class="slide level2 smaller" data-number="6.44">
<h2><span class="header-section-number">6.44</span> Teorema de Cybenko</h2>
<ul>
<li>Un perceptrÃ³n multicapa, con una capa oculta, es capaz de establecer un mapeo entre dos conjuntos de datos cualesquiera (Teorema de Cybenko).</li>
<li>Por lo tanto, cuando se aplica el perceptrÃ³n multicapa a un problema real para aproximar una funciÃ³n continua y no se consigue la precisiÃ³n deseada es porque no se ha conseguido una determinaciÃ³n adecuada de los pesos sinÃ¡pticos de la red o no se ha utilizado el nÃºmero apropiado de unidades de proceso en la capa oculta</li>
<li>Probemos a solucionar problemas mÃ¡s complejos: <a href="https://playground.tensorflow.org" class="uri">https://playground.tensorflow.org</a></li>
</ul>
</section>
<section id="si-son-tan-potentes-por-quÃ©-sufrieron-un-largo-invierno-las-ann" class="slide level2 smaller" data-number="6.45">
<h2><span class="header-section-number">6.45</span> Si son tan potentes Â¿por quÃ© sufrieron un largo invierno las ANN?</h2>
<ul>
<li>Hinton concretÃ³ algunos de los problemas histÃ³ricos:
<ul>
<li>Nuestros conjuntos de datos etiquetados eran muy pequeÃ±os</li>
<li>Nuestros ordenadores eran millones demasiado lentos</li>
<li>Inicializamos los pesos de forma estÃºpida.</li>
<li>Utilizamos el tipo incorrecto de no linealidad.</li>
</ul></li>
</ul>
</section>
<section id="interpretabilidad-de-la-ann" class="slide level2" data-number="6.46">
<h2><span class="header-section-number">6.46</span> Interpretabilidad de la ANN</h2>
<ul>
<li>Las ANNs no son interpretables.</li>
<li>Veamos la siguiente comparaciÃ³n entre un Ã¡rbol y una red neuronal</li>
</ul>

<img data-src="images/image-1254155885.png" class="r-stretch"></section>
<section id="cÃ³mo-decidimos-el-nÃºmero-de-capas-ocultas" class="slide level2 smaller" data-number="6.47">
<h2><span class="header-section-number">6.47</span> Â¿CÃ³mo decidimos el nÃºmero de capas ocultas?</h2>
<ul>
<li>El nÃºmero de capas puede determinar el tipo de fronteras que pueden generarse
<ul>
<li>En muchos casos, dos capas (una oculta) y una funciÃ³n de activaciÃ³n sigmoidea son muy efectivas en problemas de reconocimiento de patrones y clasicaciÃ³n</li>
<li>Existe un interÃ©s creciente en las llamadas redes profundas</li>
<li>Cuantas mÃ¡s capas ocultas aÃ±adamos, mÃ¡s costoso, computacionalmente hablando, es el algoritmo</li>
</ul></li>
</ul>
</section>
<section id="cÃ³mo-decidimos-el-nÃºmero-de-neuronas-por-capa" class="slide level2 smaller" data-number="6.48">
<h2><span class="header-section-number">6.48</span> Â¿CÃ³mo decidimos el nÃºmero de neuronas por capa?</h2>
<ul>
<li>El nÃºmero de neuronas de la capa de entrada estÃ¡ determinada por las dimensiones del problema</li>
<li>Y el de la capa de salida por el nÃºmero de clases</li>
<li>El nÃºmero de neuronas ocultas es una decisiÃ³n de diseÃ±o
<ul>
<li>Si usamos pocas neuronas, la red serÃ¡ incapaz de modelar fronteras complejas</li>
<li>Si usamos demasiadas, la red tendrÃ¡ problemas para generalizar (sobreajuste)</li>
</ul></li>
<li>Lo mÃ¡s recomendable es usar validaciÃ³n cruzada</li>
</ul>
</section>
<section id="ejemplo-r-de-ann" class="slide level2 smaller" data-number="6.49">
<h2><span class="header-section-number">6.49</span> Ejemplo R de ANN</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="do">#############################################</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="do">## ANN</span></span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="do">#############################################</span></span>
<span id="cb94-4"><a href="#cb94-4"></a></span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="co"># librerÃ­as del modelo</span></span>
<span id="cb94-6"><a href="#cb94-6"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'nnet'</span>)) <span class="fu">install.packages</span>(<span class="st">'nnet'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="fu">library</span>(nnet)</span>
<span id="cb94-8"><a href="#cb94-8"></a></span>
<span id="cb94-9"><a href="#cb94-9"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb94-10"><a href="#cb94-10"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb94-11"><a href="#cb94-11"></a>md_ann <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb94-12"><a href="#cb94-12"></a>                <span class="at">data=</span>Xy_train, </span>
<span id="cb94-13"><a href="#cb94-13"></a>                <span class="at">method=</span><span class="st">"nnet"</span>, </span>
<span id="cb94-14"><a href="#cb94-14"></a>                <span class="at">preProcess=</span><span class="st">"center"</span>,</span>
<span id="cb94-15"><a href="#cb94-15"></a>                <span class="at">trControl=</span>fitControl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  11
initial  value 123.354754 
iter  10 value 31.969497
iter  20 value 3.762732
iter  30 value 2.676000
iter  40 value 2.596336
iter  50 value 2.508608
iter  60 value 2.481182
iter  70 value 2.289991
iter  80 value 2.220382
iter  90 value 2.005052
iter 100 value 2.000465
final  value 2.000465 
stopped after 100 iterations</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb96-2"><a href="#cb96-2"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_ann, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb96-3"><a href="#cb96-3"></a></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb96-5"><a href="#cb96-5"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb96-6"><a href="#cb96-6"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb98-3"><a href="#cb98-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         15         2
  virginica       0          0        13

Overall Statistics
                                          
               Accuracy : 0.9556          
                 95% CI : (0.8485, 0.9946)
    No Information Rate : 0.3333          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.9333          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            1.0000           0.8667
Specificity                 1.0000            0.9333           1.0000
Pos Pred Value              1.0000            0.8824           1.0000
Neg Pred Value              1.0000            1.0000           0.9375
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3333           0.2889
Detection Prevalence        0.3333            0.3778           0.2889
Balanced Accuracy           1.0000            0.9667           0.9333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_ann, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      setosa  versicolor    virginica
1  0.9989235 0.001076491 3.417801e-46
2  0.9988320 0.001168003 4.381552e-46
6  0.9987905 0.001209478 4.872679e-46
16 0.9989463 0.001053703 3.202258e-46
18 0.9988631 0.001136865 4.035508e-46
20 0.9988821 0.001117915 3.834180e-46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb102-2"><a href="#cb102-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  0.999 0.999 0.999 0.999 0.999 ...
 $ versicolor  : num  0.00108 0.00117 0.00121 0.00105 0.00114 ...
 $ virginica   : num  3.42e-46 4.38e-46 4.87e-46 3.20e-46 4.04e-46 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># curvas roc</span></span>
<span id="cb104-2"><a href="#cb104-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb104-3"><a href="#cb104-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb104-4"><a href="#cb104-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb104-5"><a href="#cb104-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb104-6"><a href="#cb104-6"></a></span>
<span id="cb104-7"><a href="#cb104-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb104-8"><a href="#cb104-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb104-9"><a href="#cb104-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb104-10"><a href="#cb104-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb104-11"><a href="#cb104-11"></a></span>
<span id="cb104-12"><a href="#cb104-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb104-13"><a href="#cb104-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb104-14"><a href="#cb104-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb104-15"><a href="#cb104-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb104-16"><a href="#cb104-16"></a></span>
<span id="cb104-17"><a href="#cb104-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-21-1.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-21-2.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-21-3.png" width="960"></p>
</div>
</div>
</section>
<section id="ejemplo-python-ann" class="slide level2 smaller" data-number="6.50">
<h2><span class="header-section-number">6.50</span> Ejemplo Python ANN</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a><span class="co">#############################################</span></span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="co">## ANN</span></span>
<span id="cb107-3"><a href="#cb107-3"></a><span class="co">#############################################</span></span>
<span id="cb107-4"><a href="#cb107-4"></a></span>
<span id="cb107-5"><a href="#cb107-5"></a><span class="co"># construcciÃ³n del modelo</span></span>
<span id="cb107-6"><a href="#cb107-6"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb107-7"><a href="#cb107-7"></a></span>
<span id="cb107-8"><a href="#cb107-8"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb107-9"><a href="#cb107-9"></a>md_ann <span class="op">=</span> MLPClassifier(max_iter<span class="op">=</span><span class="dv">600</span>)</span>
<span id="cb107-10"><a href="#cb107-10"></a>md_ann.fit(X_train_scaled, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-6 {color: black;background-color: white;}#sk-container-id-6 pre{padding: 0;}#sk-container-id-6 div.sk-toggleable {background-color: white;}#sk-container-id-6 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-6 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-6 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-6 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-6 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-6 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-6 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-6 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-6 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-6 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-6 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-6 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-6 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-6 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-6 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-6 div.sk-item {position: relative;z-index: 1;}#sk-container-id-6 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-6 div.sk-item::before, #sk-container-id-6 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-6 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-6 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-6 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-6 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-6 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-6 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-6 div.sk-label-container {text-align: center;}#sk-container-id-6 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-6 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-6" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>MLPClassifier(max_iter=600)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" checked=""><label for="sk-estimator-id-6" class="sk-toggleable__label sk-toggleable__label-arrow">MLPClassifier</label><div class="sk-toggleable__content"><pre>MLPClassifier(max_iter=600)</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb108-2"><a href="#cb108-2"></a>y_pred <span class="op">=</span> md_ann.predict(X_test_scaled)</span>
<span id="cb108-3"><a href="#cb108-3"></a></span>
<span id="cb108-4"><a href="#cb108-4"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb108-5"><a href="#cb108-5"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0 10  0]
 [ 0  1 16]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.91      1.00      0.95        10
           2       1.00      0.94      0.97        17

    accuracy                           0.98        45
   macro avg       0.97      0.98      0.97        45
weighted avg       0.98      0.98      0.98        45</code></pre>
</div>
</div>
</section>
<section id="ejemplo-python-ann-2" class="slide level2 smaller" data-number="6.51">
<h2><span class="header-section-number">6.51</span> Ejemplo Python ANN 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb112-2"><a href="#cb112-2"></a>y_test_proba_predict <span class="op">=</span> md_ann.predict_proba(X_test_scaled)</span>
<span id="cb112-3"><a href="#cb112-3"></a></span>
<span id="cb112-4"><a href="#cb112-4"></a><span class="co"># curva roc</span></span>
<span id="cb112-5"><a href="#cb112-5"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb112-6"><a href="#cb112-6"></a></span>
<span id="cb112-7"><a href="#cb112-7"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb112-8"><a href="#cb112-8"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="probando-el-perceptrÃ³n-con-tensorflow-en-python" class="slide level2 smaller" data-number="6.52">
<h2><span class="header-section-number">6.52</span> Probando el perceptrÃ³n con Tensorflow en Python</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a><span class="co"># Librerias necesarias</span></span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb113-3"><a href="#cb113-3"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb113-4"><a href="#cb113-4"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb113-5"><a href="#cb113-5"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb113-6"><a href="#cb113-6"></a></span>
<span id="cb113-7"><a href="#cb113-7"></a><span class="co"># versiÃ³n de tensorflow</span></span>
<span id="cb113-8"><a href="#cb113-8"></a>tf.__version__</span>
<span id="cb113-9"><a href="#cb113-9"></a></span>
<span id="cb113-10"><a href="#cb113-10"></a><span class="co"># Datos a aprender</span></span>
<span id="cb113-11"><a href="#cb113-11"></a>n_hab <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb113-12"><a href="#cb113-12"></a></span>
<span id="cb113-13"><a href="#cb113-13"></a>precio <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>,<span class="dv">3</span>,<span class="fl">3.5</span>], dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb113-14"><a href="#cb113-14"></a></span>
<span id="cb113-15"><a href="#cb113-15"></a><span class="co"># VisualizaciÃ³n de los datos</span></span>
<span id="cb113-16"><a href="#cb113-16"></a>plt.plot(n_hab,precio, <span class="st">"o"</span>)</span>
<span id="cb113-17"><a href="#cb113-17"></a></span>
<span id="cb113-18"><a href="#cb113-18"></a><span class="co">###############################################</span></span>
<span id="cb113-19"><a href="#cb113-19"></a><span class="co"># MLP con 1 capa</span></span>
<span id="cb113-20"><a href="#cb113-20"></a><span class="co">###############################################</span></span>
<span id="cb113-21"><a href="#cb113-21"></a></span>
<span id="cb113-22"><a href="#cb113-22"></a><span class="co"># La definiciÃ³n del modelo toma una lista de capas como parÃ¡metro </span></span>
<span id="cb113-23"><a href="#cb113-23"></a><span class="co"># que especifica el orden de cÃ¡lculo desde la entrada a la salida:</span></span>
<span id="cb113-24"><a href="#cb113-24"></a><span class="co"># - input_shape=[1] â Especifica que la entrada a la capa tiene un valor simple (x1)</span></span>
<span id="cb113-25"><a href="#cb113-25"></a><span class="co"># - units=1 â NÃºmero de neuronas en la capa. </span></span>
<span id="cb113-26"><a href="#cb113-26"></a></span>
<span id="cb113-27"><a href="#cb113-27"></a>capa <span class="op">=</span> tf.keras.layers.Dense(units<span class="op">=</span><span class="dv">1</span>,input_shape<span class="op">=</span>[<span class="dv">1</span>])</span>
<span id="cb113-28"><a href="#cb113-28"></a>md_vivienda <span class="op">=</span> tf.keras.Sequential([capa])</span>
<span id="cb113-29"><a href="#cb113-29"></a></span>
<span id="cb113-30"><a href="#cb113-30"></a><span class="co"># Se compila el modelo con dos parÃ¡metros:</span></span>
<span id="cb113-31"><a href="#cb113-31"></a><span class="co"># - Loss function â Una forma de medir lo lejos que estÃ¡n las predicciones del resultado deseado. </span></span>
<span id="cb113-32"><a href="#cb113-32"></a><span class="co">#                 (La diferencia se llama pÃ©rdida o "loss".)</span></span>
<span id="cb113-33"><a href="#cb113-33"></a><span class="co"># - Optimizer function â Una forma de ajustar los valores internos para reducir la pÃ©rdida con tasa aprendizaje</span></span>
<span id="cb113-34"><a href="#cb113-34"></a></span>
<span id="cb113-35"><a href="#cb113-35"></a>md_vivienda.<span class="bu">compile</span>(optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.1</span>), loss<span class="op">=</span><span class="st">"mean_squared_error"</span>)</span>
<span id="cb113-36"><a href="#cb113-36"></a></span>
<span id="cb113-37"><a href="#cb113-37"></a><span class="co"># resumen del modelo</span></span>
<span id="cb113-38"><a href="#cb113-38"></a>md_vivienda.summary()</span>
<span id="cb113-39"><a href="#cb113-39"></a></span>
<span id="cb113-40"><a href="#cb113-40"></a><span class="co"># Se entrena el modelo</span></span>
<span id="cb113-41"><a href="#cb113-41"></a>historial <span class="op">=</span> md_vivienda.fit(x<span class="op">=</span>n_hab, y<span class="op">=</span>precio, epochs<span class="op">=</span><span class="dv">30</span>, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb113-42"><a href="#cb113-42"></a><span class="bu">print</span>(<span class="st">"modelo entrenado"</span>)</span>
<span id="cb113-43"><a href="#cb113-43"></a></span>
<span id="cb113-44"><a href="#cb113-44"></a><span class="co"># ParÃ¡metros de history</span></span>
<span id="cb113-45"><a href="#cb113-45"></a>historial.params</span>
<span id="cb113-46"><a href="#cb113-46"></a></span>
<span id="cb113-47"><a href="#cb113-47"></a><span class="co"># Se visualiza la evoluciÃ³n de loss</span></span>
<span id="cb113-48"><a href="#cb113-48"></a>plt.xlabel(<span class="st">'Ãpocas'</span>)</span>
<span id="cb113-49"><a href="#cb113-49"></a>plt.ylabel(<span class="st">"PÃ©rdida"</span>)</span>
<span id="cb113-50"><a href="#cb113-50"></a>plt.plot(historia.history[<span class="st">"loss"</span>])</span>
<span id="cb113-51"><a href="#cb113-51"></a>plt.show()</span>
<span id="cb113-52"><a href="#cb113-52"></a></span>
<span id="cb113-53"><a href="#cb113-53"></a><span class="co"># Usamos el modelo para predecir nuevos casos</span></span>
<span id="cb113-54"><a href="#cb113-54"></a><span class="bu">print</span>(md_vivienda.predict([<span class="fl">7.0</span>]))</span>
<span id="cb113-55"><a href="#cb113-55"></a></span>
<span id="cb113-56"><a href="#cb113-56"></a><span class="co"># Pesos de las capas</span></span>
<span id="cb113-57"><a href="#cb113-57"></a>ecuacion <span class="op">=</span> capa.get_weights()</span>
<span id="cb113-58"><a href="#cb113-58"></a><span class="bu">print</span>(ecuacion)</span>
<span id="cb113-59"><a href="#cb113-59"></a><span class="bu">print</span>(<span class="st">"precio_vivienda = "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">float</span>(ecuacion[<span class="dv">0</span>][<span class="dv">0</span>])) <span class="op">+</span> <span class="st">" * n_habitaciones + "</span> <span class="op">+</span> (<span class="bu">str</span>(<span class="bu">float</span>(ecuacion[<span class="dv">1</span>][<span class="dv">0</span>]))))</span>
<span id="cb113-60"><a href="#cb113-60"></a></span>
<span id="cb113-61"><a href="#cb113-61"></a><span class="co">###############################################</span></span>
<span id="cb113-62"><a href="#cb113-62"></a><span class="co"># MLP con 2 capas ocultas</span></span>
<span id="cb113-63"><a href="#cb113-63"></a><span class="co">###############################################</span></span>
<span id="cb113-64"><a href="#cb113-64"></a>oculta1 <span class="op">=</span> tf.keras.layers.Dense(units<span class="op">=</span><span class="dv">3</span>,input_shape<span class="op">=</span>[<span class="dv">1</span>])</span>
<span id="cb113-65"><a href="#cb113-65"></a>oculta2 <span class="op">=</span> tf.keras.layers.Dense(units<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb113-66"><a href="#cb113-66"></a>salida <span class="op">=</span> tf.keras.layers.Dense(units<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb113-67"><a href="#cb113-67"></a></span>
<span id="cb113-68"><a href="#cb113-68"></a>md_vivienda2 <span class="op">=</span> tf.keras.Sequential([oculta1, oculta2, salida])</span>
<span id="cb113-69"><a href="#cb113-69"></a></span>
<span id="cb113-70"><a href="#cb113-70"></a><span class="co"># se compila modelo</span></span>
<span id="cb113-71"><a href="#cb113-71"></a>md_vivienda2.<span class="bu">compile</span>(optimizer<span class="op">=</span>tf.keras.optimizers.Adam(<span class="fl">0.1</span>), loss<span class="op">=</span><span class="st">"mean_squared_error"</span>)</span>
<span id="cb113-72"><a href="#cb113-72"></a></span>
<span id="cb113-73"><a href="#cb113-73"></a><span class="co"># Se entrena el modelo</span></span>
<span id="cb113-74"><a href="#cb113-74"></a>historial2 <span class="op">=</span> md_vivienda2.fit(x<span class="op">=</span>n_hab, y<span class="op">=</span>precio, epochs<span class="op">=</span><span class="dv">100</span>, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb113-75"><a href="#cb113-75"></a><span class="bu">print</span>(<span class="st">"modelo entrenado"</span>)</span>
<span id="cb113-76"><a href="#cb113-76"></a></span>
<span id="cb113-77"><a href="#cb113-77"></a><span class="co"># Se visualiza la evoluciÃ³n de loss</span></span>
<span id="cb113-78"><a href="#cb113-78"></a>plt.xlabel(<span class="st">'Ãpocas'</span>)</span>
<span id="cb113-79"><a href="#cb113-79"></a>plt.ylabel(<span class="st">"PÃ©rdida"</span>)</span>
<span id="cb113-80"><a href="#cb113-80"></a>plt.plot(historial2.history[<span class="st">"loss"</span>])</span>
<span id="cb113-81"><a href="#cb113-81"></a>plt.show()</span>
<span id="cb113-82"><a href="#cb113-82"></a></span>
<span id="cb113-83"><a href="#cb113-83"></a><span class="bu">print</span>(md_vivienda2.predict([<span class="fl">7.0</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="bagging.-random-forest" class="title-slide slide level1 center" data-number="7">
<h1><span class="header-section-number">7</span> Bagging. Random Forest</h1>

</section>
<section id="introducciÃ³n-al-ensamble" class="slide level2 smaller" data-number="7.1">
<h2><span class="header-section-number">7.1</span> IntroducciÃ³n al ensamble</h2>
<ul>
<li>A veces puede darse el caso en que ninguno de los modelos hasta ahora presentados proporciona resultados convincentes para nuestro problema.</li>
<li>El aprendizaje ensamblado es un paradigma que en lugar de entrenar un modelo muy preciso se centra en entrenar un gran nÃºmero de modelos con baja precisiÃ³n y despuÃ©s combinar sus predicciones para obtener un metamodelo una precisiÃ³n mÃ¡s alta.</li>
<li>Los modelos de baja precisiÃ³n son entrenados por algoritmos dÃ©biles, es decir, algoritmos incapaces de aprender modelos complejos</li>
<li>generalmente son rÃ¡pidos tanto en tiempos de entrenamiento como de procesamiento.</li>
<li>Existen dos paradigmas de aprendizaje ensamblado:
<ul>
<li>el bagging</li>
<li>el boosting.</li>
</ul></li>
</ul>
</section>
<section id="bagging" class="slide level2 smaller" data-number="7.2">
<h2><span class="header-section-number">7.2</span> Bagging</h2>
<ul>
<li>En vez de buscar la divisiÃ³n mÃ¡s eficiente en cada capa como ocurre en el Ã¡rbol de decisiÃ³n, una alternativa serÃ­a construir multiples Ã¡rboles de decisiÃ³n y combinar sus resultados.</li>
<li>Esta tÃ©cnica se conoce como bagging y consiste en hacer crecer varios Ã¡rboles utilizando una selecciÃ³n aleatoria de los datos que se usan para cada Ã¡rbol</li>
<li>Combinando la predicciÃ³n de cada uno de ellos a travÃ©s de la media, en el caso de regresiÃ³n, o mediante un sistema de votaciÃ³n, en el caso de un problema de clasificaciÃ³n</li>
<li>La tÃ©cnica se podrÃ­a emplear de forma similar con otros clasificadores distintos a los Ã¡rboles</li>
</ul>
</section>
<section id="boostrap" class="slide level2 smaller" data-number="7.3">
<h2><span class="header-section-number">7.3</span> Boostrap</h2>
<ul>
<li>La principal caracterÃ­stica del bagging es el llamado muestreo bootstrap.</li>
<li>La intuiciÃ³n tras esto es que para que los Ã¡rboles generen una respuesta Ãºnica, debe existir aleatoriedad y variaciÃ³n en cada Ã¡rbol que conforme el modelo final</li>
<li>no tendrÃ­a sentido construir varios Ã¡rboles identicos.</li>
<li>Este problema queda resuelto por el muestreo bootstrap, el cual extrae una variaciÃ³n aleatoria de los datos en cada ronda.</li>
<li>En el caso del bagging, se ejecutan distintas muestras de datos para el entrenamiento de cada Ã¡rbol.</li>
<li>el bagging es una tÃ©cnica de gran eficacia para el tratamiento de los valores atipicos que generalmente afecta a un Ãºnico Ã¡rbol de decisiÃ³n.</li>
</ul>
</section>
<section id="introducciÃ³n-al-random-forest" class="slide level2" data-number="7.4">
<h2><span class="header-section-number">7.4</span> IntroducciÃ³n al Random Forest</h2>
<ul>
<li>El bagging es el paradigma tras el algoritmo de Random Forest.</li>
<li>Este algoritmo fue desarrollado por primera vez por Tin Kam Ho en 1995</li>
<li>Sin embargo, fueron Cutler y Breiman quienes desarrollaron una versiÃ³n extendida del modelo y registraron <strong>Random Forest</strong> como marca comercial.</li>
</ul>
</section>
<section id="random-forest.-algoritmo" class="slide level2 smaller" data-number="7.5">
<h2><span class="header-section-number">7.5</span> Random Forest. Algoritmo</h2>
<ul>
<li>El algoritmo bÃ¡sico de bagging funciona del siguiente modo:
<ul>
<li>a partir del conjunto de entrenamiento, se generan <span class="math inline">\(K\)</span> muestras aleatorias <span class="math inline">\(\mathbb{S}_{k}\)</span></li>
<li>se entrena un modelo de Ã¡rbol de decisiÃ³n <span class="math inline">\(f_k\)</span> utilizando cada muestra <span class="math inline">\(\mathbb{S}_{k}\)</span> como el conjunto de entrenamiento.</li>
<li>tras el entrenamiento, se dispone de <span class="math inline">\(K\)</span> Ã¡rboles de decisiÃ³n.</li>
<li>La predicciÃ³n de una nueva observaciÃ³n <span class="math inline">\(x\)</span> se obtiene como la media de las <span class="math inline">\(K\)</span> predicciones:</li>
</ul></li>
</ul>
<span class="math display">\[\begin{equation}
y\leftarrow\hat{f}(x)=\frac{1}{K}\sum^{K}_{k=1}f_{k}(x)
\end{equation}\]</span>
<p>en el caso de regresiÃ³n, o por la mayorÃ­a de votaciÃ³n en el caso de clasificaciÃ³n.</p>
</section>
<section id="caracterÃ­sticas-de-random-forest" class="slide level2 smaller" data-number="7.6">
<h2><span class="header-section-number">7.6</span> CaracterÃ­sticas de Random Forest</h2>
<ul>
<li>Suele ser mejor que estÃ© formado por una gran cantidad de Ã¡rboles (por lo menos 100) para suavizar el impacto de valores atÃ­picos. Sin embargo, la tasa de efectividad disminuye a medida que se incorporan mÃ¡s Ã¡rboles. Llegado a cierto punto, los nuevos Ã¡rboles no aportan una mejora significativa al modelo pero si incrementan los tiempos de procesamiento.</li>
<li>El modelo Random Forest es rÃ¡pido de entrenar y es una buena tÃ©cnica para obtener un modelo de referencia. Finalmente, aunque estos modelos funcionan bien en la interpretaciÃ³n de patrones complejos y son versatiles, otras tÃ©cnicas, como por ejemplo el gradient boosting, proporcionan una mayor precisiÃ³n en las predicciones.</li>
<li>Son populares porque tienden a proporcionar un muy buen rendimiento con los modelos predeterminados. A pesar de tener muchos hiperparametros, los valores por defecto de estos tienden a ofrecer buenos resultados en la predicciÃ³n. Los hiperparametros mÃ¡s importantes que hay que ajustar son: el nÃºmero de Ã¡rboles (<span class="math inline">\(K\)</span>), el numero de variables incluidos en el subconjunto aleatorio en cada divisiÃ³n (<span class="math inline">\(mtry\)</span>), la complejidad de cada Ã¡rbol, el esquema de muestreo y la regla de divisiÃ³n a utilizar durante la construcciÃ³n del Ã¡rbol.</li>
</ul>
</section>
<section id="ejemplo-grÃ¡fico-de-random-forest" class="slide level2 smaller" data-number="7.7">
<h2><span class="header-section-number">7.7</span> Ejemplo grÃ¡fico de Random Forest</h2>

<img data-src="images/image-786828792.png" class="r-stretch"></section>
<section id="ejemplo-r-de-random-forest" class="slide level2 smaller" data-number="7.8">
<h2><span class="header-section-number">7.8</span> Ejemplo R de Random Forest</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="do">#############################################</span></span>
<span id="cb114-2"><a href="#cb114-2"></a><span class="do">## RF</span></span>
<span id="cb114-3"><a href="#cb114-3"></a><span class="do">#############################################</span></span>
<span id="cb114-4"><a href="#cb114-4"></a></span>
<span id="cb114-5"><a href="#cb114-5"></a><span class="co"># librerÃ­as del modelo</span></span>
<span id="cb114-6"><a href="#cb114-6"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'randomForest'</span>)) <span class="fu">install.packages</span>(<span class="st">'randomForest'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb114-7"><a href="#cb114-7"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb114-8"><a href="#cb114-8"></a></span>
<span id="cb114-9"><a href="#cb114-9"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb114-10"><a href="#cb114-10"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb114-11"><a href="#cb114-11"></a>md_rf <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb114-12"><a href="#cb114-12"></a>               <span class="at">data=</span>Xy_train, </span>
<span id="cb114-13"><a href="#cb114-13"></a>               <span class="at">method=</span><span class="st">"rf"</span>, </span>
<span id="cb114-14"><a href="#cb114-14"></a>               <span class="at">trControl=</span>fitControl)</span>
<span id="cb114-15"><a href="#cb114-15"></a></span>
<span id="cb114-16"><a href="#cb114-16"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb114-17"><a href="#cb114-17"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_rf, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb114-18"><a href="#cb114-18"></a></span>
<span id="cb114-19"><a href="#cb114-19"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb114-20"><a href="#cb114-20"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb114-21"><a href="#cb114-21"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb116-3"><a href="#cb116-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         14         2
  virginica       0          1        13

Overall Statistics
                                         
               Accuracy : 0.9333         
                 95% CI : (0.8173, 0.986)
    No Information Rate : 0.3333         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.9            
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.9333           0.8667
Specificity                 1.0000            0.9333           0.9667
Pos Pred Value              1.0000            0.8750           0.9286
Neg Pred Value              1.0000            0.9655           0.9355
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3111           0.2889
Detection Prevalence        0.3333            0.3556           0.3111
Balanced Accuracy           1.0000            0.9333           0.9167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb118-2"><a href="#cb118-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_rf, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb118-3"><a href="#cb118-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   setosa versicolor virginica
1   1.000      0.000     0.000
2   0.996      0.002     0.002
6   1.000      0.000     0.000
16  0.972      0.028     0.000
18  1.000      0.000     0.000
20  1.000      0.000     0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb120-2"><a href="#cb120-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb120-3"><a href="#cb120-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  1 0.996 1 0.972 1 1 1 1 0.99 1 ...
 $ versicolor  : num  0 0.002 0 0.028 0 0 0 0 0.01 0 ...
 $ virginica   : num  0 0.002 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="co"># curvas roc</span></span>
<span id="cb122-2"><a href="#cb122-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb122-3"><a href="#cb122-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb122-4"><a href="#cb122-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb122-5"><a href="#cb122-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb122-6"><a href="#cb122-6"></a></span>
<span id="cb122-7"><a href="#cb122-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb122-8"><a href="#cb122-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb122-9"><a href="#cb122-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb122-10"><a href="#cb122-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb122-11"><a href="#cb122-11"></a></span>
<span id="cb122-12"><a href="#cb122-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb122-13"><a href="#cb122-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb122-14"><a href="#cb122-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb122-15"><a href="#cb122-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb122-16"><a href="#cb122-16"></a></span>
<span id="cb122-17"><a href="#cb122-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-25-3.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-25-4.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-25-5.png" width="960"></p>
</div>
</div>
</section>
<section id="ejemplo-python-random-forest" class="slide level2 smaller" data-number="7.9">
<h2><span class="header-section-number">7.9</span> Ejemplo Python Random Forest</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1"></a><span class="co">#############################################</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="co">## Random Forest</span></span>
<span id="cb125-3"><a href="#cb125-3"></a><span class="co">#############################################</span></span>
<span id="cb125-4"><a href="#cb125-4"></a></span>
<span id="cb125-5"><a href="#cb125-5"></a><span class="co"># construcciÃ³n del modelo</span></span>
<span id="cb125-6"><a href="#cb125-6"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb125-7"><a href="#cb125-7"></a></span>
<span id="cb125-8"><a href="#cb125-8"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb125-9"><a href="#cb125-9"></a>md_rf <span class="op">=</span> RandomForestClassifier()</span>
<span id="cb125-10"><a href="#cb125-10"></a>md_rf.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-7 {color: black;background-color: white;}#sk-container-id-7 pre{padding: 0;}#sk-container-id-7 div.sk-toggleable {background-color: white;}#sk-container-id-7 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-7 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-7 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-7 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-7 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-7 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-7 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-7 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-7 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-7 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-7 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-7 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-7 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-7 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-7 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-7 div.sk-item {position: relative;z-index: 1;}#sk-container-id-7 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-7 div.sk-item::before, #sk-container-id-7 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-7 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-7 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-7 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-7 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-7 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-7 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-7 div.sk-label-container {text-align: center;}#sk-container-id-7 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-7 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-7" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" checked=""><label for="sk-estimator-id-7" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb126-2"><a href="#cb126-2"></a>y_pred <span class="op">=</span> md_rf.predict(X_test)</span>
<span id="cb126-3"><a href="#cb126-3"></a></span>
<span id="cb126-4"><a href="#cb126-4"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb126-5"><a href="#cb126-5"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0 10  0]
 [ 0  3 14]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.77      1.00      0.87        10
           2       1.00      0.82      0.90        17

    accuracy                           0.93        45
   macro avg       0.92      0.94      0.92        45
weighted avg       0.95      0.93      0.93        45</code></pre>
</div>
</div>
</section>
<section id="ejemplo-python-random-forest-2" class="slide level2 smaller" data-number="7.10">
<h2><span class="header-section-number">7.10</span> Ejemplo Python Random Forest 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>y_test_proba_predict <span class="op">=</span> md_rf.predict_proba(X_test)</span>
<span id="cb130-3"><a href="#cb130-3"></a></span>
<span id="cb130-4"><a href="#cb130-4"></a><span class="co"># curva roc</span></span>
<span id="cb130-5"><a href="#cb130-5"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb130-6"><a href="#cb130-6"></a></span>
<span id="cb130-7"><a href="#cb130-7"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb130-8"><a href="#cb130-8"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="bossting.-xgboost" class="title-slide slide level1 center" data-number="8">
<h1><span class="header-section-number">8</span> Bossting. XGboost</h1>

</section>
<section id="introducciÃ³n-boosting" class="slide level2 smaller" data-number="8.1">
<h2><span class="header-section-number">8.1</span> IntroducciÃ³n boosting</h2>
<ul>
<li>La lÃ³gica de los algoritmos boosting es combinar modelos dÃ©biles para conseguir un modelo fuerte.</li>
<li>En este caso, el tÃ©rmino âdÃ©bilâ hace referencia a un modelo con poco poder predictivo pero mejor que una predicciÃ³n aleatoria. Mientras que âfuerteâ es considerado un buen predictor para los datos.</li>
<li>Para llegar a un algoritmo fuerte a partir de varios modelos debiles es necesario introducir ponderaciones a los Ã¡rboles basadas en las clasificaciones erroneas del Ã¡rbol anterior.</li>
</ul>
</section>
<section id="sobre-ajuste-vs-boosting" class="slide level2" data-number="8.2">
<h2><span class="header-section-number">8.2</span> Sobre ajuste vs boosting</h2>
<ul>
<li>El boosting reduce el problema del sobreajuste utilizando menos Ã¡rboles que un modelo Random Forest.</li>
<li>Mientras que agregar mÃ¡s Ã¡rboles al Random Forest ayuda a compensar el sobreajuste, tambiÃ©n puede llevar a un aumento del mismo; y por ello hay que ser cauteloso a la hora de agregar nuevos Ã¡rboles.</li>
<li>El enfoque del boosting de apreder reiteradamente de los errores anteriores puede llevarle a generar sobreajuste.</li>
</ul>
</section>
<section id="problemas-boosting" class="slide level2 smaller" data-number="8.3">
<h2><span class="header-section-number">8.3</span> Problemas boosting</h2>
<ul>
<li>Aunque ese enfoque produce predicciones mÃ¡s precisas, muchas veces mejores a la mayorÃ­a de algoritmos, puede llevar a ajustar las observaciones atÃ­picas.</li>
<li>Por ello, el Random Forest es una tÃ©cnica mÃ¡s recomendada para conjuntos de datos muy complejos con un gran nÃºmero de observaciones atÃ­picas.</li>
<li>Otra de las grandes desventajas del boosting es que tiene unos elevados tiempos de procesamiento dado que su entrenamiento sigue una lÃ³gica secuencial. Puesto que un Ã¡rbol debe esperar al anterior para ser entrenado, se limita la escalabilidad del modelo. Sobre todo cuando se agregan mÃ¡s Ã¡rboles. Mientras tanto, un Random Forest entrena los Ã¡rboles en paralelo, lo que hace que sea mÃ¡s rÃ¡pido de procesar.</li>
<li>El inconveniente que es aplicable tanto a los algoritmos de boosting como a los de bagging, es la perdidad de la simplicidad visual y la dificultad de interpretaciÃ³n que tienen respecto a un simple Ã¡rbol de decisiÃ³n.</li>
</ul>
</section>
<section id="gradient-boosting" class="slide level2 smaller" data-number="8.4">
<h2><span class="header-section-number">8.4</span> Gradient boosting</h2>
<ul>
<li>Uno de los algoritmos de boosting mÃ¡s famosos es el gradient boosting</li>
<li>Mientras que el Random Forest seleccionaba combinaciones aleatorias de variables, el gradient boosting selecciona variables que mejoren la precisiÃ³n con cada nuevo Ã¡rbol.</li>
<li>La construcciÃ³n del modelo secuencial puesto que cada nuevo Ã¡rbol se crea utilizando informaciÃ³n derivada del Ã¡rbol anterior, y en consecuencia no son independientes.</li>
<li>En cada iteraciÃ³n se registran los errores cometidos en los datos de entrenamiento y se aplican a la siguiente ronda de datos de entrenamiento.</li>
<li>AdemÃ¡s, se agregan pesos a los datos basandose en los resultados de la iteraciÃ³n anterior.</li>
<li>Las ponderaciones mÃ¡s altas se aplicarÃ¡n a los datos que fueron errorneamente clasificados, y no se aplicarÃ¡ tanta atenciÃ³n a los bien clasificados.</li>
<li>Este proceso se repite hasta que se llega a un nivel bajo de error.</li>
<li>El resultado final se obtiene a travÃ©s de la media ponderada de las predicciones de los Ã¡rboles de decisiÃ³n</li>
</ul>
</section>
<section id="ejemplo-grÃ¡fico-de-boosting" class="slide level2 smaller" data-number="8.5">
<h2><span class="header-section-number">8.5</span> Ejemplo grÃ¡fico de boosting</h2>

<img data-src="images/image-1954953036.png" class="r-stretch"></section>
<section id="ejemplo-r-de-xgboost" class="slide level2 smaller" data-number="8.6">
<h2><span class="header-section-number">8.6</span> Ejemplo R de XGboost</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-r">Section&nbsp;1.34</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="do">#############################################</span></span>
<span id="cb131-2"><a href="#cb131-2"></a><span class="do">## XGB</span></span>
<span id="cb131-3"><a href="#cb131-3"></a><span class="do">#############################################</span></span>
<span id="cb131-4"><a href="#cb131-4"></a></span>
<span id="cb131-5"><a href="#cb131-5"></a><span class="co"># librerÃ­as del modelo</span></span>
<span id="cb131-6"><a href="#cb131-6"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">'xgboost'</span>)) <span class="fu">install.packages</span>(<span class="st">'xgboost'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span>
<span id="cb131-7"><a href="#cb131-7"></a><span class="fu">library</span>(xgboost)</span>
<span id="cb131-8"><a href="#cb131-8"></a></span>
<span id="cb131-9"><a href="#cb131-9"></a><span class="co"># construcciÃ³n del modelo y entrenamiento</span></span>
<span id="cb131-10"><a href="#cb131-10"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"none"</span>,<span class="at">classProbs=</span>T,<span class="at">number =</span> <span class="dv">1</span>)</span>
<span id="cb131-11"><a href="#cb131-11"></a>md_xgb <span class="ot">&lt;-</span> <span class="fu">train</span>(form, </span>
<span id="cb131-12"><a href="#cb131-12"></a>               <span class="at">data=</span>Xy_train, </span>
<span id="cb131-13"><a href="#cb131-13"></a>               <span class="at">method=</span><span class="st">"xgbLinear"</span>, </span>
<span id="cb131-14"><a href="#cb131-14"></a>               <span class="at">trControl=</span>fitControl)</span>
<span id="cb131-15"><a href="#cb131-15"></a></span>
<span id="cb131-16"><a href="#cb131-16"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb131-17"><a href="#cb131-17"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_xgb, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y])</span>
<span id="cb131-18"><a href="#cb131-18"></a></span>
<span id="cb131-19"><a href="#cb131-19"></a><span class="co"># dataframe con datos entrada y prediccion</span></span>
<span id="cb131-20"><a href="#cb131-20"></a>o_pred <span class="ot">=</span> <span class="fu">data.frame</span>(Xy_test,<span class="at">pred=</span>y_pred)</span>
<span id="cb131-21"><a href="#cb131-21"></a><span class="fu">head</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species   pred
1           5.1         3.5          1.4         0.2  setosa setosa
2           4.9         3.0          1.4         0.2  setosa setosa
6           5.4         3.9          1.7         0.4  setosa setosa
16          5.7         4.4          1.5         0.4  setosa setosa
18          5.1         3.5          1.4         0.3  setosa setosa
20          5.1         3.8          1.5         0.3  setosa setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb133-2"><a href="#cb133-2"></a>mc <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span> (y_pred, Xy_test[,y])</span>
<span id="cb133-3"><a href="#cb133-3"></a>mc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

            Reference
Prediction   setosa versicolor virginica
  setosa         15          0         0
  versicolor      0         14         2
  virginica       0          1        13

Overall Statistics
                                         
               Accuracy : 0.9333         
                 95% CI : (0.8173, 0.986)
    No Information Rate : 0.3333         
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.9            
                                         
 Mcnemar's Test P-Value : NA             

Statistics by Class:

                     Class: setosa Class: versicolor Class: virginica
Sensitivity                 1.0000            0.9333           0.8667
Specificity                 1.0000            0.9333           0.9667
Pos Pred Value              1.0000            0.8750           0.9286
Neg Pred Value              1.0000            0.9655           0.9355
Prevalence                  0.3333            0.3333           0.3333
Detection Rate              0.3333            0.3111           0.2889
Detection Prevalence        0.3333            0.3556           0.3111
Balanced Accuracy           1.0000            0.9333           0.9167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb135-2"><a href="#cb135-2"></a>y_test_proba_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(md_xgb, <span class="at">newdata=</span>Xy_test[,<span class="sc">-</span>y], <span class="at">type =</span> <span class="st">"prob"</span>)</span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="fu">head</span>(y_test_proba_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     setosa  versicolor   virginica
1 0.9934760 0.004926376 0.001597704
2 0.9927455 0.004922753 0.002331812
3 0.9936201 0.004927090 0.001452784
4 0.9905413 0.008010399 0.001448282
5 0.9934760 0.004926376 0.001597704
6 0.9934760 0.004926376 0.001597704</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="co"># Se aÃ±ade la data.frame la probabilidad de cada clase</span></span>
<span id="cb137-2"><a href="#cb137-2"></a>o_pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(o_pred,y_test_proba_predict )</span>
<span id="cb137-3"><a href="#cb137-3"></a><span class="fu">str</span>(o_pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   45 obs. of  9 variables:
 $ Sepal.Length: num  5.1 4.9 5.4 5.7 5.1 5.1 5.1 4.6 5.5 4.9 ...
 $ Sepal.Width : num  3.5 3 3.9 4.4 3.5 3.8 3.7 3.6 4.2 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.7 1.5 1.4 1.5 1.5 1 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.4 0.4 0.3 0.3 0.4 0.2 0.2 0.2 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ pred        : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ setosa      : num  0.993 0.993 0.994 0.991 0.993 ...
 $ versicolor  : num  0.00493 0.00492 0.00493 0.00801 0.00493 ...
 $ virginica   : num  0.0016 0.00233 0.00145 0.00145 0.0016 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="co"># curvas roc</span></span>
<span id="cb139-2"><a href="#cb139-2"></a>roc_setosa <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>setosa, Xy_test[,y] <span class="sc">==</span> <span class="st">"setosa"</span>)</span>
<span id="cb139-3"><a href="#cb139-3"></a><span class="fu">colnames</span>(roc_setosa) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb139-4"><a href="#cb139-4"></a>pred_setosa <span class="ot">=</span> <span class="fu">prediction</span>(roc_setosa<span class="sc">$</span>predict, roc_setosa<span class="sc">$</span>label);</span>
<span id="cb139-5"><a href="#cb139-5"></a>perf_setosa <span class="ot">=</span> <span class="fu">performance</span>(pred_setosa, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb139-6"><a href="#cb139-6"></a></span>
<span id="cb139-7"><a href="#cb139-7"></a>roc_virginica <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>virginica, Xy_test[,y] <span class="sc">==</span> <span class="st">"virginica"</span>)</span>
<span id="cb139-8"><a href="#cb139-8"></a><span class="fu">colnames</span>(roc_virginica) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb139-9"><a href="#cb139-9"></a>pred_virginica <span class="ot">=</span> <span class="fu">prediction</span>(roc_virginica<span class="sc">$</span>predict, roc_virginica<span class="sc">$</span>label);</span>
<span id="cb139-10"><a href="#cb139-10"></a>perf_virginica <span class="ot">=</span> <span class="fu">performance</span>(pred_virginica, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb139-11"><a href="#cb139-11"></a></span>
<span id="cb139-12"><a href="#cb139-12"></a>roc_versicolor <span class="ot">=</span> <span class="fu">data.frame</span>(o_pred<span class="sc">$</span>versicolor, Xy_test[,y] <span class="sc">==</span> <span class="st">"versicolor"</span>)</span>
<span id="cb139-13"><a href="#cb139-13"></a><span class="fu">colnames</span>(roc_versicolor) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"predict"</span>, <span class="st">"label"</span>);</span>
<span id="cb139-14"><a href="#cb139-14"></a>pred_versicolor <span class="ot">=</span> <span class="fu">prediction</span>(roc_versicolor<span class="sc">$</span>predict, roc_versicolor<span class="sc">$</span>label);</span>
<span id="cb139-15"><a href="#cb139-15"></a>perf_versicolor <span class="ot">=</span> <span class="fu">performance</span>(pred_versicolor, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>);</span>
<span id="cb139-16"><a href="#cb139-16"></a></span>
<span id="cb139-17"><a href="#cb139-17"></a><span class="fu">plot</span>(perf_setosa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-28-3.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a><span class="fu">plot</span>(perf_virginica)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-28-4.png" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="fu">plot</span>(perf_versicolor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-28-5.png" width="960"></p>
</div>
</div>
</section>
<section id="ejemplo-python-xgboost" class="slide level2 smaller" data-number="8.7">
<h2><span class="header-section-number">8.7</span> Ejemplo Python XGboost</h2>
<ul>
<li>Previamente a este ejemplo se ha debido de realizar el proceso de hold-out <a href="#/sec-hold-out-python">Section&nbsp;1.35</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1"></a><span class="co">#############################################</span></span>
<span id="cb142-2"><a href="#cb142-2"></a><span class="co">## Xgboots</span></span>
<span id="cb142-3"><a href="#cb142-3"></a><span class="co">#############################################</span></span>
<span id="cb142-4"><a href="#cb142-4"></a></span>
<span id="cb142-5"><a href="#cb142-5"></a><span class="co"># construcciÃ³n del modelo</span></span>
<span id="cb142-6"><a href="#cb142-6"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> GradientBoostingClassifier</span>
<span id="cb142-7"><a href="#cb142-7"></a></span>
<span id="cb142-8"><a href="#cb142-8"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb142-9"><a href="#cb142-9"></a>md_xgb <span class="op">=</span> GradientBoostingClassifier()</span>
<span id="cb142-10"><a href="#cb142-10"></a>md_xgb.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<style>#sk-container-id-8 {color: black;background-color: white;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: "â¸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "â¾";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GradientBoostingClassifier()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" checked=""><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">GradientBoostingClassifier</label><div class="sk-toggleable__content"><pre>GradientBoostingClassifier()</pre></div></div></div></div></div>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1"></a><span class="co"># predicciÃ³n del conjunto de test</span></span>
<span id="cb143-2"><a href="#cb143-2"></a>y_pred <span class="op">=</span> md_xgb.predict(X_test)</span>
<span id="cb143-3"><a href="#cb143-3"></a></span>
<span id="cb143-4"><a href="#cb143-4"></a><span class="co"># matriz de confusiÃ³n y mÃ©tricas de precisiÃ³n</span></span>
<span id="cb143-5"><a href="#cb143-5"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[18  0  0]
 [ 0 10  0]
 [ 0  4 13]]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        18
           1       0.71      1.00      0.83        10
           2       1.00      0.76      0.87        17

    accuracy                           0.91        45
   macro avg       0.90      0.92      0.90        45
weighted avg       0.94      0.91      0.91        45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1"></a></span>
<span id="cb147-2"><a href="#cb147-2"></a><span class="co"># obtenciÃ³n probabilidad de cada clase de la variable objetivo</span></span>
<span id="cb147-3"><a href="#cb147-3"></a>y_test_proba_predict <span class="op">=</span> md_xgb.predict_proba(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ejemplo-python-xgboost-2" class="slide level2 smaller" data-number="8.8">
<h2><span class="header-section-number">8.8</span> Ejemplo Python XGboost 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1"></a><span class="co"># curva roc</span></span>
<span id="cb148-2"><a href="#cb148-2"></a><span class="im">import</span> scikitplot <span class="im">as</span> skplt <span class="co"># %pip install scikit-plot</span></span>
<span id="cb148-3"><a href="#cb148-3"></a></span>
<span id="cb148-4"><a href="#cb148-4"></a>skplt.metrics.plot_roc(y_true<span class="op">=</span>y_test, y_probas<span class="op">=</span>y_test_proba_predict)</span>
<span id="cb148-5"><a href="#cb148-5"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="ML-TEMA-03_files/figure-revealjs/unnamed-chunk-30-1.png" width="960"></p>
</div>
</div>
<p><img src="images/logo-enae.jpg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="ML-TEMA-03_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="ML-TEMA-03_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="ML-TEMA-03_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': true,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>